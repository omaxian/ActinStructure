\documentclass[11pt]{article}
\linespread{1.5} 
\usepackage{graphicx,epstopdf,subfigure,mathtools,mathrsfs, arydshln, amsmath, amssymb} 
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{float}
\usepackage{authblk}
\usepackage[title]{appendix}
\PassOptionsToPackage{usenames,dvipsnames}{xcolor}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage[normalem]{ulem}

\usepackage{amsfonts}
\usepackage{hyperref}
\hypersetup{
    colorlinks=false,
    pdfborder={0 0 0},
}
\newcommand{\new}[1]{\color{blue}#1\normalcolor}
\newcommand{\red}[1]{\color{red}#1\normalcolor}
\newcommand{\delete}[1]{}
\newcommand{\change}[1]{\color{black}#1\normalcolor}
\newcommand{\rev}[1]{\color{black}#1\normalcolor}


% VECTOR AND MATRIX NOTATION
\newcommand{\V}[1]{\boldsymbol{#1}}                 % vector notation
\newcommand{\M}[1]{\boldsymbol{#1}}
\global\long\def\Xin{\V{X}^\text{(in)}}
\global\long\def\Xout{\V{X}^\text{(out)}}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert} 
\newcommand{\Lop}[1]{\boldsymbol{\mathcal{#1}}}
\newcommand{\C}[1]{c_{#1}} 
\global\long\def\Rrxn{R_\text{rxn}}
\global\long\def\kdp{k_d^+}
\global\long\def\kdm{k_d^-}
\global\long\def\ktrp{k_\text{tr}^+}
\global\long\def\ktrm{k_\text{tr}^-}
\global\long\def\kfp{k_f^+}
\global\long\def\kfm{k_f^-}
\global\long\def\kbp{k_b^+}
\global\long\def\kbm{k_b^-}
\global\long\def\kpp{k_p^+}
\global\long\def\kpm{k_p^-}
\global\long\def\kforn{k_\text{for}^{(n)}}
\global\long\def\kforp{k_\text{for}^+}
\global\long\def\kform{k_\text{for}^-}
\global\long\def\kbrp{k_\text{brnc}^+}
\global\long\def\kbrm{k_\text{brnc}^-}
\global\long\def\afor{\alpha_\text{for}}
\global\long\def\Nm{N_1}
\global\long\def\Nd{N_2}
\global\long\def\Ntr{N_3}

\title{Simulations of linear and branched actin networks with formin and arp 2/3 complex as mediators  \vspace{-0.5 cm}}
\author{Ondrej Maxian  \vspace{-0.75 cm}}

\begin{document}
\maketitle

\section{Introduction} 
A great mystery in cell biology is how cells mediate the assembly of different cytoskeletal structures at different times in the cell cycle. One important example of this is branched vs.\ linear actin filament networks. When cells migrate, they form a branched network at their leading edge, which can be important for stable adhesion to a substrate. On the other hand, when cells divide, they form a contractile ring of linear actin filaments. The unidirectional (non-branched) nature of the ring is vital to transmit force in the correct direction for the completion of cytokinesis \cite{alberts}. 

While it is clear that different network architectures are required for different cellular functions, the molecular mechanisms by which cells control the assembly of branched vs.\ linear actin structures are still incompletely understood. At the most basic level, linear actin filaments can assemble in two ways: via formin-mediated assembly, and via spontaneous nucleation \cite{alberts, pollard2007regulation}. Seeing as spontaneous nucleation is highly unfavorable energetically, formin can significantly speed up filament nucleation \cite{rosenbloom2021mechanism} to the point where it dominates assembly dynamics. This is also the case in the presence of profilin \cite{schutt1993structure}, which can block the spontaneous nucleation of filaments, thereby causing filament assembly to be dependent on formin \cite{alberts, pollard1984quantitative}. 

Branched actin networks are dependent on a different assembly factor called the arp 2/3 complex. While this complex can aid in nucleation of linear filaments, assembly is most efficient when it binds to an existing ``mother'' filament. The fixed binding angle of arp 2/3 complex (typically around 70 degrees) causes the formation of tree-like branched actin networks \cite{pollard2007regulation, alberts}. Because the arp 2/3 complex fixes the minus end of the ``daughter'' filament onto the mother, the branches can only grow from their plus ends, and thus branched structures do not exhibit treadmilling and are typically more stable than their linear counterparts \cite{alberts, ni2019turnover, liman2020role}. Unlike formin networks, whose growth is aided by the presence of profilin, arp 2/3-complex-mediated growth is \emph{inhibited} by profilin, which blocks the association of an arp 2/3 activator (WASP VCA) with monomeric actin, a step which is necessary for branch formation \cite{suarez2015profilin}. 

While the key molecular players in branched vs.\ linear network formation are by now well understood, there is still some debate over exactly \emph{how} the cell might program the actin to polymerize into one type of structure vs.\ the other. In the simplest case when there is exactly one structure formed, the kinetics become quite simple: the elongation rate is proportional to a constant times the amount of available (free) actin monomers \cite{suarez2016internetwork}, and the dissociation rate is constant. Solving the simple equation $k_\text{on} C=k_\text{off}$ gives an equilibrium concentration (about 0.1 $\mu$M) at which the structure assumes a steady state size. But introducing multiple structures (either of the same kind or of different types), throws off this balance, as actin assembly kinetics alone do not provide a mechanism for controlling the size (length) or type (linear vs.\ branched) of multiple actin structures \cite{mohapatra2017limiting}. To control this, the conventional viewpoint is that external or internal signals \cite{carlier2017global} activate signaling cascades which eventually cause the cell to produce more or less of a particular type of network \cite{martin2005tea4p, pollard2007regulation, suarez2016internetwork}. However, recent experimental evidence has shown that a limiting actin pool must also play a part in determining the types of structures being produced \cite{burke2014homeostatic}. 

The general evidence for the limiting pool model is as follows: if cells only use signaling to preferentially organize actin into one particular type of structure, then changes in the actin concentration should affect the amount, but not the relative proportion, of linear vs.\ branched networks. However, experiments in fission yeast show that underexpression of actin favors formin-mediated linear structures, while overexpression favors arp 2/3-complex-mediated actin patches \cite{burke2014homeostatic}. Another important set of observations comes from inhibition of arp 2/3 complex. As long as there is sufficient formin, inhibition of arp 2/3 (via drug CK-666) leads to new assembly of filamentous structures, as might be expected (see \cite{xu2023cooperative} for a similar result in plant cells). However, subsequent wash out of CK-666 gives disassembly of the additional filamentous structures and subsequent reassembly of dense actin patches \cite{burke2014homeostatic}. These results suggest that the release of F-actin via disassembly is important for the assembly of new structures \cite{suarez2016internetwork}, and that the occupation of monomers in existing branched structures limits the amount of linear filaments that can be created. Such a scenario was shown to be important in cytokinesis in \emph{C.\ elegans}, where depleting the arp 2/3 complex gives an excess of filamentous actin and consequent delays in cell division \cite{chan2019arp2}. It was also shown that depleting arp 2/3 decreases actin turnover times (by increasing the amount of available actin) in the cortex of \emph{drosophila} embryos \cite{xie2021combinatorial}, demonstrating the versatility of these results across organisms.

These recent \emph{in vivo} experimental studies have spawned a number of \emph{in vitro} and \emph{in silico} (modeling) studies that attempt to understand how a limiting actin pool might set the balance between linear and branched filament networks. Thus far, studies concerned with size control have ignored the precise geometry of branched networks, and have instead looked at filamentous actin structures only, finding that the steady state length distribution of individual filaments (or structures) is not well defined \cite{mohapatra2017limiting,harbage2016exact} because actin kinetics only set the total amount of actin incorporated. In fact, the limiting pool hypothesis predicts that structures with slightly higher on rates will capture all of the monomers at equilibrium \cite{mohapatra2017limiting}. But this is not the behavior we observe \emph{in vivo}, where the balance between branched and filamentous actin is maintained at a relative steady state in time. 

There are a number of potential explanations for why the steady state theory does not match the experimental results. A first possibility is that each individual structure has an inherent mechanism of size control, in particular if there is a net negative feedback in the growth rate as a function of the structure size  \cite{banerjee2022size}. Such feedback could occur through fragmentation and annealing, where longer segments detach and attach to monomers, and fragmentation of longer filaments at steady states balances annealing of shorter ones \cite{fass2008stochastic}. Another mechanism for length-dependent attachment rate could occur in vivo from sensing of the cell boundary \cite{mcinally2021scaling} or from the dynamics of linear filaments in bundles \cite{rosario2023universal}. In fact, recent work \cite{mcinally2023length} has suggested that size control can also emerge in a feedback-independent way if filaments form bundles (couples the dynamics of multiple filaments into one structure) and are removed randomly from the bundle with an independent probability (leads to a steady state because long filaments eventually get removed). 

A second possibility for why the \emph{in vivo} experiments do not match steady state predictions is more obvious: what if the cell simply is not operating at steady state? Indeed, it has been shown that intermediate filament lengths are quasi-stable on timescales of a few hours, and that the drift to steady state occurs on timescales as long as days \cite{hu2007theoretical,suarez2017enough}. The intermediate-timescale regime was the focus of \cite{banerjee2022emergence}, where it was found that spontaneous nucleation of actin filaments gives rise to a quasi-stable, near-uniform length distribution, which can change to exponential in the presence of capping protein. This kind of length distribution does not match the expected steady state exponential one \cite{edelstein1998models}, because it is only stable on intermediate timescales. Nevertheless, these timescales, which are on the order of tens of minutes to a few hours, are the most relevant in \emph{in vitro} experiments and in the cell itself, where cell-cycle cues typically take place every few hours to change the environment. 

%\red{There are additional confounding agents that could tip the scales in one direction or the other. We focus on two: profilin and capping protein. In general, the presence of profilin correlates with more filamentous actin structures \cite{suarez2016internetwork}, as actin binding to profilin prevents filament nucleation but allows for barbed end growth \cite{pollard2007regulation}. Depletion of capping protein increases arp 2/3-mediated patches by at least 35\% \cite{suarez2016internetwork}. This is confusing because capping protein competes with formin for barbed ends \cite{kovar2005profilin}, and so we would expect depleting capping protein to increase formin levels and lead to more filamentous actin.}

\subsection{The focus of this study}
It is therefore clear that further study is necessary to clear up how the balance of actin assembly changes on short to intermediate to long timescales. In addition, while previous size-control studies are pleasingly general \cite{banerjee2022size, mohapatra2017limiting}, the fact remains that branched actin networks \emph{require} the presence of linear filaments to form, and so the specific modeling of branched and linear networks is necessary to truly understand how formin and arp 2/3 complex compete for actin monomers. Our goal in this study is to address these two points: by specifically modeling branched and linear networks, we can get an idea of how a limiting actin pool alone can give rise to different network architectures. And by simulating dynamically, we can understand how long the quasi-steady states with near uniform filament length distributions can persist in time \cite{banerjee2022emergence}. 

Because some of the \emph{in vitro} experiments on these systems pattern formin in one place and arp 2/3 complex in another, it will be important to look at the spatial dynamics of the filaments. Yet, because the nucleation reactions are reaction-limited, and because most reaction rates are reported in terms of bulk concentrations, it makes little sense to explicitly track actin monomers in space. Because of this, we settle on a hybrid approach where we treat actin nucleates as bulk quantities, which form fibers at random points in space. While we will not do so in this draft, our approach can be extended to incorporate diffusion, hydrodynamics, and explicit forces on the filaments which affect their dynamics. %Once the fibers form, we track their positions explicitly. Because we will not consider hydrodynamic interactions in this system, the Brownian dynamics approach is straightforward \cite{makino2004brownian, delong2015brownian}. 

The simulation approach we employ is an amalgamation of previous work \cite{fass2008stochastic, ni2019turnover, banerjee2022emergence}. As in \cite{fass2008stochastic, banerjee2022emergence}, we use a stochastic simulation algorithm to simulate a list of well-mixed reactions involving filaments and formins, but in this work we add the simulation of branched actin networks. Similar to \cite{ni2019turnover, liman2020role}, we explicitly simulate branched actin networks, since their geometry (the number of branches and length of each branch) determines the rate of monomer binding and the possibility of arp 2/3 complex binding to form another branch. Unlike in \cite{ni2019turnover}, however, we do not explicitly track individual actin monomers in space, which allows us to reach longer time and lengthscales. Specifically, we do not introduce seed filaments to skip the lag phase of actin assembly \cite{chandrasekaran2022nucleation}, and are consequently able to explicitly simulate the actin nucleation reactions proposed in \cite{rosenbloom2021mechanism} to obtain a more accurate picture of how formin-based nucleation competes with spontaneous nucleation. Combining tools from these previous works allows us to study, for the first time to our knowledge, the spatial and temporal dynamics of how formins and arp 2/3 compete for actin monomers to form linear vs.\ branched networks.

We begin this report where others have left off: stochastic simulation of actin filament dynamics. In Section \ref{sec:FilAct}, we review what by now is a well-established approach to the simulation of filament assembly, except that we incorporate the most complete picture of spontaneous nucleation developed in \cite{rosenbloom2021mechanism}. We simulate the dynamics of F-actin assembly both with and without formins, which we assume can both nucleate new filaments and speed the rate of elongation at the barbed end. Then, in Section\ \ref{sec:BF}, we lay out our model of branched filaments, including how they form from a combination of arp 2/3 complex and existing filaments. We then simulate the formation of branched actin structures with and without formin.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}\hline
Parameter & Description & Value & Units \\ \hline
%$a$ & Actin diameter & 4 & nm & & \\
%$k_B T$ & Thermal energy & $4.1 \times 10^{-3}$ & pN$\cdot \mu$m & & \\ 
%$\mu$ & Fluid viscosity & 0.01 & Pa$\cdot$s & & $D=2k_BT/(6 \pi \mu a)\approx 11$ $\mu$m$^2$/s \\  \hline
$\kdp$ & Dimer formation rate& $3.5 \times 10^{-6}$ & $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$\kdp$ & Dimer formation rate& $5.8 \times 10^{-9}$ & $\mu$m$^{3} \cdot$s$^{-1}$ & & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\kdm$ & Dimer dissociation rate & 0.041 & s$^{-1}$\\ \hline
$\ktrp$ & Trimer formation rate& $13 \times 10^{-5}$ & $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$\ktrp$ & Trimer formation rate& $2.2 \times 10^{-7}$ & $\mu$m$^{3} \cdot$s$^{-1}$ &  & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\ktrm$ & Trimer dissociation rate & 22 & s$^{-1}$ \\ \hline
$k_b^+$ & Barbed end addition rate& 11.6 & $\mu$M$^{-1}\cdot$s$^{-1}$ \\ 
%$k_b^+$ &  Barbed end addition rate& 0.019 & $\mu$m$^{3} \cdot$s$^{-1}$ &  & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$k_b^-$ & Barbed end dissociation rate & 1.4 & s$^{-1}$\\ \hline
$k_p^+$ & Pointed end addition rate& 1.3& $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$k_p^+$ &  Pointed end addition rate& $2.2 \times 10^{-3}$ & $\mu$m$^{3} \cdot$s$^{-1}$ & & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$k_p^-$ & Pointed end dissociation rate & 0.8 & s$^{-1}$ \\ \hline
\end{tabular}
\caption{\label{tab:params} Parameter values for filament nucleation and growth \cite{rosenbloom2021mechanism}. }
\end{center}
\end{table}



\section{Stochastic simulations of filamentous actin \label{sec:FilAct}}
%The previous section showed that the actin nucleation reaction is severely reaction-limited, and that the steady state can be well-approximated assuming that the system is well mixed. Because of this, we seem to be wasting quite a lot of effort tracking the diffusion of individual monomers, especially since tracking them requires us to search for neighbors at every time step. The need to search for reaction neighbors led us to a first-order accurate reaction scheme for simplicity, which limits the time step size so that $k\Delta t \ll 1$, where $k$ is the \emph{fastest} reaction rate (binding of a monomer to a barbed end). Figure\ \ref{fig:FiveRealP} showed that this requires $\Delta t \approx 10^{-4}$ s, and we are interested in simulating timescales on the order of $10^3$ to $10^4$ s. These simulations, while doable, would be quite costly. 
This section discusses our algorithm for linear filaments. The process of actin polymerization can be separated into a nucleation step and elongation step. In the nucleation step, two actin monomers come together to form a dimer, which then must be joined by another monomer to form a trimer. A trimer has a barbed and pointed end, and monomers can associate at those ends with the same rate as longer filaments. The reactions in the system are therefore: dimer formation and breakup, trimer formation and breakup, and polymerization and depolymerization from the barbed/pointed end of each filament. Table\ \ref{tab:params} lists the parameters, which come from the recent study \cite{rosenbloom2021mechanism}.

As already mentioned in the introduction, we do not explicitly track ``filaments'' (really nucleates) of length 3 or smaller, instead only keeping a count of how many are in the system. Once a tetramer forms, we insert it randomly into the spatial domain and start to track its location explicitly. This allows us to retain some spatial dependence (which will be necessary later when we try to mimic \emph{in vitro} experiments) while not wasting computational time on steps we know are well mixed. Thus, in our system, the key unknowns are the number of monomers, dimers, and trimers, and the length (and coordinates in space) of each filament. Section\ \ref{sec:SSA} gives more details on the stochastic reaction scheme. 

\subsection{Simulations of actin polymerization without spatial dynamics}
We now perform stochastic simulations of actin polymerization using the algorithm in Section\ \ref{sec:SSA}. In these simulations, we do not simulate the diffusion of the fibers, as there is no reason to do so if we are not interested in spatial information. We consider systems with various concentrations of monomers (2,5, and 10 $\mu$M) in a box of size $125$ $\mu$m$^3$ (5 $\mu$m on each side). 

\begin{figure}
\centering
\subfigure[Dynamics of polymerization]{
\includegraphics[width=0.48\textwidth]{FreeActinTimeConc.eps}
\includegraphics[width=0.48\textwidth]{FibersTimeConc.eps}}
\subfigure[Distribution of fiber sizes]{
\includegraphics[width=\textwidth]{LengthDistsConc.eps}}
\caption{\label{fig:ActinPolyMix}Stochastic simulations of polymerization dynamics at three different concentrations. (a) The dynamics of polymerization, with the concentration of free monomers shown at left and the number of fibers per unit volume (1 $\mu$m$^3$) shown at right. The number of fibers comes to a steady state when about half the actin is depleted. (b) The distribution of fiber sizes (in terms of the number of monomers) at three different time points for each concentration.}
\end{figure}

Figure\ \ref{fig:ActinPolyMix} shows the results of our simulations. The dynamics can be divided into a ``lag phase'' for nucleation (which is longer for smaller concentrations), followed by a ``growth phase'' (in which free actin is incorporated into the existing fibers), terminated by an ``equilibrium phase.'' At the end of the lag phase, the number of fibers per volume reaches a steady state, so that in the growth phase the decrease in free actin is driven exclusively by incorporation into existing fibers. After the growth phase is complete, the concentration of free actin remains constant at 0.17 $\mu$M, and the fibers must exchange monomers with other fibers to grow in length \cite{hu2007theoretical}.

Similar to \cite{banerjee2022emergence}, we do not concern ourselves with the long-time ``steady state'' distribution of actin filament lengths, which can take days to reach \cite{hu2007theoretical, fass2008stochastic, mohapatra2017limiting}, and instead focus on the length distributions on an intermediate timescale of a 30 minutes to 3 hours, which corresponds to a typical timescale for \emph{in vitro} experiments. Our results for the filament length distributions, which are shown in Fig.\ \ref{fig:ActinPolyMix}(b), match those of \cite{banerjee2022emergence} for spontaneous nucleation of filaments: intermediate timescales show a quasi-stable length distribution which is skewed to the left and quite broad (c.f.\ \cite[Fig.~2c]{banerjee2022emergence}), and higher concentrations have lower mean filament lengths (since more filaments are nucleated faster, the filaments that are nucleated first do not suck up as many monomers prior to nucleation of other filaments). 

\subsection{Incorporating formins}
\red{Pick up here.} We now incorporate formin into the filament dynamics. We assume that formin can do three things,
\begin{enumerate}
\item Formin can nucleate filaments by binding two actin monomers in the reaction $F+A+A \rightarrow FA_2$, which is irreversible and has rate $\kforn$ \cite{paul2008role, zweifel2021nucleation}. To accomplish this, we add a reaction to our stochastic simulations in Section \ref{sec:SSA} which describes the binding of formin to two actin monomers with rate $\left(\kforn/V^2\right)N_\text{for}\Nm^2 $. If chosen, we decrease the number of formins by 1 and the number of monomers by 2 and instantiate a fiber with two monomers and formin bound to the bound end. Following previous studies \cite{paul2008role, zweifel2021nucleation}, we do not allow formin nucleates to break apart (this reaction is irreversible). 
\item This fiber can add monomers to the barbed and pointed ends, with a modified rate at the barbed end $\afor \kbp$. It can also depolymerize from both ends with the normal rates (until it becomes a dimer).
\item Formin can bind and unbind from existing filament barbed ends, with rates $\kforp$ and $\kform$, respectively. According to our previous definition, a ``filament'' has 4 or more monomers. As such, we only allow formin to bind/unbind from filaments with 4 or more monomers.
\end{enumerate}


\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}\hline
Parameter & Description & Value & Units & Ref & Notes \\ \hline
$\kforn$ & Filament nucleation by formin & $2 \times 10^{-4}$ & $\mu$M$^{-2}\cdot$s$^{-1}$& \cite{paul2008role} & \\ 
$\kforn$ & Filament nucleation by formin & $5.5 \times 10^{-10}$ & $\mu$m$^{6} \cdot$s$^{-1}$ & \cite{paul2008role} & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\ 
$\kforp$ & Formin association to barbed ends& 29.1 & $\mu$M$^{-1} \cdot $s$^{-1}$ & \cite{shekhar2015formin}& \\
$\kforp$ & Formin association to barbed ends&0.048 & $\mu$m$^{3} \cdot$s$^{-1}$ & \cite{shekhar2015formin}& 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\kform$ & Formin dissociation from barbed ends& $8.1 \times 10^{-5}$ & s $^{-1}$ & \cite{shekhar2015formin}& \\
$\afor$ & Enhanced growth for formin barbed ends & 1--10 & & &\\ \hline
\end{tabular}
\caption{\label{tab:paramsF} Parameter values for formin.}
\end{center}
\end{table}

\subsection{Results with formin filament nucleation}
\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{FreeMonConcFormin.eps}
\includegraphics[width=0.48\textwidth]{FractionFreeFormin.eps}
\includegraphics[width=0.6\textwidth]{FibersPerVolFormin.eps}
\caption{\label{fig:ActinNucWithFormin}Dynamics of actin polymerization (at 5 $\mu$M) when formin nucleates actin filaments. Top left: the concentration of free actin monomers over time. The colors correspond to different formin concentrations. Top right: the fraction of free formins over time. Bottom: the number of fibers per unit volume. Once again, each color represents a different formin concentration. Here, however, the solid lines give the total density of filaments per volume, while the dotted lines give the density of formin-bound filaments.}
\end{figure}

We now consider how nucleating filaments with formin affects the dynamics of actin polymerization at a fixed actin concentration of 5 $\mu$M. Figure\ \ref{fig:ActinNucWithFormin} shows the concentration of free monomers, fraction of free formins, and fiber density (with and without bound formins) from simulations lasting 2000 s, in which we include formin at concentrations varying from 0 to 5 nM. At low ($\leq 0.2$ nM) formin concentrations, the dynamics closely resemble the spontaneous nucleation case; we see that it takes about 1500 s to reach the steady state concentration of free monomers, and that at these time points all of the formins are bound to filaments (the fraction of free formins is about zero). At these low formin concentrations, there are a substantial number of filaments which are \emph{not} attached to formin, since there are not enough formins available to bind all the filaments. As we increase the formin concentration, more formins become available. These formins bind rapidly to actin monomers to nucleate filaments, and the time to reach the steady state free monomer concentration drops drastically. At high formin (1 nM or higher) concentrations, there are at least 50\% free formins at all times, and every filament has an attached formin. 

\begin{figure}
\centering
\includegraphics[width=\textwidth]{LengthHistsFormin.eps}
\caption{\label{fig:HistsWithFormin}Length distribution for actin filaments in simulations with formin of varying concentrations. We show the distributions at three time points ($t=500$ s in blue, $t=1000$ s in red, and $t=2000$ s in yellow) of fiber sizes (in terms of the number of monomers) at three different time points for each concentration. The distributions become more uniform (smaller range) as the formin concentration increases.}
\end{figure}

How do these dynamics affect the length distribution of fibers? As shown in Fig.\ \ref{fig:HistsWithFormin}, and as previously reported in \cite{banerjee2022emergence}, an increase in the formin concentration leads to the nucleation of more filaments at early times, which translates to a smaller mean and standard deviation in the number of monomers per filament (a more uniform distribution of filament lengths). In our results, at high formin concentrations we start to see a drift in the distribution at late times (see $t=2000$ for 5 nM formin), which reflects the fact that the length distribution we report here is \emph{not} the true steady state, but a quasi-steady state reached before the exchange of monomers on existing fibers \cite{mohapatra2017limiting}.

\subsubsection{Faster formin-induced elongation}
Now that we have looked at the role of formin in \emph{nucleating} filaments, we need to consider its role in \emph{lengthening} filaments. As has already been noted \cite{banerjee2022emergence}, when all the fibers have bound formins, the dynamics are relatively uninteresting, since the elongation rate, though faster than the base rate, is still the same on every filament. The interesting dynamics come when some of the filaments are formin-bound and others are not. For this reason, in this section we fix the actin concentration at 5 $\mu$M and the formin concentration at 0.12 nM, so that we would expect about 1/2 of the filaments to be formin bound (this is an interpolation between 0.1 nM and 0.2 nM in Fig.\ \ref{fig:ActinNucWithFormin}). 

\begin{figure}
\centering
\subfigure[Dynamics of polymerization]{
\includegraphics[width=0.48\textwidth]{FreeMonForminAlpha.eps}
\includegraphics[width=0.48\textwidth]{NFibsForminAlpha.eps}}
\subfigure[Distribution of fiber sizes]{
\includegraphics[width=\textwidth]{LengthDistsForminAlpha.eps}}
\caption{\label{fig:ForminAlpha}How the barbed-end growth rate with formin attached affects polymerization dynamics and fiber distribution. (a) The dynamics of polymerization, with the concentration of free monomers shown at left and the number of fibers per unit volume (1 $\mu$m$^3$) shown at right (the amount of free formin, which in all cases decays to zero on the same timescale, is not shown here). In the plot at right, the colors represent the different values of $\afor$, the solid lines are the total amount of fibers, and the dotted lines are fibers with bound formins. (b) The distribution of fiber sizes (in terms of the number of monomers) at three different time points ($t=500$, $t=1000$, and $t=2000$) for the three values of $\afor$.}
\end{figure}

Based on previous studies \cite{zweifel2021nucleation, funk2019profilin}, we consider the possibility that formin could both enhance ($\afor > 1$) and reduce ($\afor < 1$) affinity for monomer binding to the barbed end. We will in particular consider values $\afor=0.5, 1$, and 2. In Fig.\ \ref{fig:ForminAlpha}, we plot the time course of polymerization and the fiber length distribution for these three values of $\afor$. In all cases, the number of \emph{formin-bound} fibers is the same, since formin is the limiting reactant here and all of it is bound to the fibers at steady state. Larger values of $\afor$ (faster speeds of polymerization at the barbed end) reduce the amount of monomers for spontaneous nucleation; consequently, the amount of fibers without formin-bound barbed ends decreases for higher barbed-end elongation rates \cite{banerjee2022emergence}.

The quasi-steady length distributions are a strong function of the barbed-end elongation rate. We begin with $\afor=1$, which is the center plot in Fig.\ \ref{fig:ForminAlpha}(b), for which we see our typical quasi-steady length distribution. When we drop to $\afor=0.5$, the formin bound fibers grow more slowly, and there is more spontaneous nucleation of filaments at later times. We therefore see a decrease in the mean and peak filament lengths. On the other hand, when we increase to $\afor=2$, the peak filament length ($2 \times 10^4$ monomers) is roughly unchanged, but there emerges a certain bimodality to the distribution as formin-bound fibers grow at double the rate of non-formin-bound ones, which is responsible for the second peak at roughly $4 \times 10^4$ monomers.

\section{Stochastic simulations of branched filaments \label{sec:BF}}
We now discuss our model of filament branching. Similar to previous work \cite{ni2019turnover}, we consider the binding of arp 2/3 complex to a linear filament, which results in the formation of a branch whose tangent vector makes a seventy degree angle with the mother filament \cite{pollard2007regulation}. Previous work \cite{beltzner2008pathway} has shown that the kinetics of actin monomers binding VCA-bound arp 2/3 complex are much faster than this complex (with or without a monomer attached) binding to an existing filament. Therefore, letting $B$ be a VCA-bound arp 2/3 complex and $N_j$ a filament of any size, the reaction proceeds in two steps
\begin{subequations}
\label{eq:BothRxnsArp}
\begin{align}
\label{eq:fastrxn}
B + N_1 \xleftrightarrow{K_\text{fast}} BN_1 \qquad & \text{(fast)}\\
BN_1 + N_j \overset{k_\text{slow}^+}{\underset{k_\text{slow}^-}\rightleftarrows} BN_1N_j \qquad & \text{(slow)}
\end{align}
\end{subequations}
To simplify this, we assume the fast reaction is in equilibrium and coarse grain this process into a single reaction involving three reactants: (VCA-bound) arp 2/3 complex $B$, an actin monomer $N_1$, and an actin filament $N_j$, 
\begin{equation}
\label{eq:ArpRxn}
B + N_1 + N_j \overset{\kbrp}{\underset{\kbrm}\rightleftarrows} BN_1N_j,
\end{equation}
Using the published values \cite{beltzner2008pathway} for the reactions\ \eqref{eq:BothRxnsArp}, we obtain our rates as 
\begin{gather*}
\kbrp = K_\text{fast} k_\text{slow}^+=\frac{\left(1.5 \times 10^{-4} \, \mu\text{M}^{-1}\text{ s}^{-1}\right)\left(15.2 \, \mu\text{M}^{-1}\text{ s}^{-1}\right)}{0.44 \text{ s}^{-1}}=5.2 \times 10^{-3} \, \mu\text{M}^{-2}\text{s}^{-1}\\
\kbrm = k_\text{slow}^- = 3.4 \times 10^{-3} \, \text{s}^{-1}.
\end{gather*}

Prior to stating the new reactions we incorporate, it is necessary to first list the geometric constraints that develop when we introduce branched networks. To simplify the process of polymerization and depolymerization, we implement the following rules:
\begin{enumerate}
\item A filament is eligible to form a branch when it has $N_\text{mb}=4$ monomers or more. Once a branch forms, it forms on the fourth monomer or higher (the first three monomers cannot form branches). 
\item The pointed end of the mother cannot unbind if a branch is sitting on the fourth monomer. This always leaves two monomers between the pointed end and the first branch. 
\item The barbed end (of a mother or a branch) cannot unbind if another branch is attached to it. 
\item Branches can only unbind if they have length 1, in which case arp 2/3 also detaches from the filament (reverse of reaction\ \eqref{eq:ArpRxn}). ``Barbed ends'' alone cannot unbind if branches have length 1 (the only unbinding is through the reverse of reaction\ \eqref{eq:ArpRxn}).
\item Formin can bind and unbind from branches with length 4 or more. In the low probability event that a branch depolymerizes to 1 monomer with a formin bound to it, that branch is prevented form unbinding. 
\end{enumerate}
This set of rules ensures simplicity in the construction and deconstruction of branched structures (in essence, the structure has to depolymerize in the order it was constructed, and cannot break into multiple branched structures). While these rules are certainly a simplification, our goal here is to study the percentage of monomers in branched structures, so whether one structure with 40 branches should in fact be two structures with 20 branches is of little consequence to us. 

Given this set of rules, we can now formulate the reactions involving arp 2/3 complex. We let $B$ be the number of free arp 2/3 complexes, and $B_j$ be a branch of length $j$. We then consider the following reactions
\begin{enumerate}
\item A branch can form with rate $r=\left(\kbrp/V^2\right) B N_1 N_\text{elig}$, where the number of fibers eligible to have a branch form is
\begin{equation}
\label{eq:NBElig}
N_\text{elig}=\sum_{j=N_\text{mb}}^M N_j+F_j +B_j.
\end{equation}
If this reaction is selected, we form a new branch with one monomer at a 70 degree angle from the mother filament (chosen at random from the branches once a particular structure is selected), and decrease $B$ by 1 and $N_1$ by 1. 
\item Branches of length one can come off the mother filament with rate $\kbrm$. This is the reverse of reaction 1, and results in $B$ and $N_1$ increasing by 1.
\item Branches can polymerize from their barbed ends only with rate $\kbp$ (no attached formins) or $\kbp \afor$ (if formin is attached). In this case, we decrease $N_1$ by 1. 
\item Branches can depolymerize from their barbed ends with rate $\kbm$, as long as the geometry permits it (see rules above). This results in $N_1$ increasing by 1.   
\item The mother filament's pointed end can depolymerize with rate $\kpp$, as long as the geometry permits it (see rules above). This also results in $N_1$ increasing by 1.   
\item Branches of length 4 or higher can bind and unbind formins from the barbed end with rates $\kforp$ and $\kform$ (resulting in $F$ decreasing or increasing by 1, respectively). 
\end{enumerate}

\subsection{Branching with spontaneous nucleation \label{sec:BrSN}}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{FreeMons_Arp.eps}
\includegraphics[width=0.6\textwidth]{FiberDensity_Arp.eps}
\caption{\label{fig:PolyDynamicsArp}Course of polymerization and assembly with 5 $\mu$M actin concentration and various concentrations of arp 2/3 (2 nM in blue, 20 nM in red, and 200 nM in yellow). The top row of plots shows how the concentration of monomers changes between free monomers (left), linear filaments (middle), and branched structures (right). The bottom plot shows the density of fibers per unit volume for each concentration, separated into linear filaments and mothers of branches (dashed-dotted line), and branches (dotted line).  }
\end{figure}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{MotherLengths_Arp23.eps}
\includegraphics[width=\textwidth]{BranchLengths_Arp23.eps}
\caption{\label{fig:LengthDistsArp} The length distribution of filaments with 5 $\mu$M actin concentration and various concentrations of arp 2/3 (2 nM at left, 20 nM in the middle, and 200 nM at right). We separate the filaments into linear and mother filaments, and show their length distribution at the top, and branches, with their length distribution at the bottom. }
\end{figure}

We begin by looking at the branching process with spontaneous nucleation of actin filaments only (no formins). We fix the actin concentration at 5 $\mu$M and vary the concentration of arp 2/3 across two orders of magnitude (2 nM, 20 nM, and 200 nM). The dynamics of polymerization and assembly are shown in Fig.\ \ref{fig:PolyDynamicsArp}, and the filament length distributions are shown in Fig.\ \ref{fig:LengthDistsArp}. 

To understand these data, it is important to remember that actin filament polymerization with spontaneous nucleation proceeds in two phases: nucleation of filaments (slow), and then elongation (fast). Obviously, nucleation of filaments is a prerequisite for branching. So in this simplified model, the two timescales that compete are the timescale of elongation and branching. Indeed, while it is true that in the limit of time to infinity we might expect to always see branched structures, if the timescale of branching is too slow we might never see any branching. This is the case at very low (2 nM) Arp 2/3 concentrations, where our results show over 90\% of the polymerized actin in linear filaments. Thus, in this regime, the timescale of branching is slower than both nucleation and elongation, and there is very little branching. 

If we increase the branched concentration to 20 nM, we see different dynamics. In this case, the number of mothers and linear fibers is the same as for 2 nM, so the branching is still sufficiently slow as to not affect the number of filaments nucleated. But when the filaments grow (on timescale between 500 and 1000 s), we see increases in the number of monomers in both branched structures and in branches. Thus elongation and branching have roughly the same timescales. In the long-time limit, we see the number of monomers in linear filaments slowly decrease as the monomers are exchanged into branched structures (although the changes are not too large, even at the highest concentration).

Finally, when we consider a concentration of 200 nM, there is a significant change in the \emph{number} of mother and linear filaments, which indicates that the branching competes with nucleation for monomers (the timescale of branching is now so fast that nucleates immediately form branches before more nucleates can form). Here we see rapid depletion of the monomer pool (faster than for 2 and 20 nM), as well as depletion of the monomers in linear filaments as more and more branches are built. 

Further understanding of the dynamics can be gained by looking at the length distributions in Fig.\ \ref{fig:LengthDistsArp}, where we have made separate distributions for linear fibers (including mothers of branches) in the top set of plots, and branches in the bottom set. For 2 nM Arp 2/3 concentration, the length distributions look similar to the case without arp 2/3, where a quasi-steady state is achieved at roughly 1000 s (there are very few branches here). For 20 nM Arp 2/3 concentration, fibers still get longer in the initial stages, but branches are formed at the same time, and there is a rough quasi-steady state in the distribution of branch lengths (this reflects the fact that branching and elongation occur on similar timescales here). By contrast, for 200 nM Arp 2/3 concentration, the quasi-steady state in the linear fibers occurs at an early time, and they do not elongate past $2 \times 10^4$ monomers. It is instead branches which form, in particular new branches, as the distribution of branch lengths becomes more and more concentrated on smaller branches over time. This is in line with our previous observation that branching is faster than elongation. 


\subsection{Adding formins}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsForminLowArp.eps}
\includegraphics[width=0.6\textwidth]{FibersForminLowArp.eps}
\caption{\label{fig:ForminLowArp}Course of polymerization and assembly with 5 $\mu$M actin concentration, 20 nM arp 2/3 concentration, and various formin concentrations and elongation ratios $\alpha$. The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}


We now add formins to see how they affect the balance of linear vs.\ branched filaments. Based on the results for spontaneous nucleation in Section\ \ref{sec:BrSN}, our expectation is that increased nucleation by formin will speed up the initial rate of linear filament formation, which will take monomers away from potential branched structures. This is exactly what we see for low Arp 2/3 concentration (20 nM) in Fig.\ \ref{fig:ForminLowArp}. At this concentration, we know that branching is not fast enough to occur at the same time as spontaneous nucleation, instead competing with elongation for monomers. Because of this, the initial dynamics at low arp concentration are dominated by formin nucleation dynamics. At zero or small (0.1 nM) formin concentrations, nucleation is not fast enough to overwhelm branching, and some of the initial monomer pool goes right to branches. However, when there is more formin (1 nM concentration), there is more nucleation, and all of the possible monomers rapidly get incorporated into linear filaments. The monomer concentration in linear filaments approaches 4.8 $\mu$M (the theoretical limit), after which it is slowly siphoned off into branches. In this case, formin ``wins'' because the arp 2/3 concentration is not high enough. At this high formin concentration, increasing the formin barbed end polymerization rate (by increasing $\alpha$) sucks more of the monomers into linear filaments. 

\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsForminHighArp.eps}
\includegraphics[width=0.6\textwidth]{FibersForminHighArp.eps}
\caption{\label{fig:ForminHighArp}Course of polymerization and assembly with 5 $\mu$M actin concentration, 200 nM arp 2/3 concentration, and various formin concentrations and elongation ratios $\alpha$. The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{Arp200nMFormin0_Snaps.eps}
\includegraphics[width=\textwidth]{Arp200nMFormin0p1_Snaps.eps}
\includegraphics[width=\textwidth]{Arp200nMFormin1_Snaps.eps}
\caption{\label{fig:ForminArpsSnaps}Snapshots of polymerization and assembly with 5 $\mu$M actin concentration, 200 nM arp 2/3 concentration, and various formin concentrations (elongation ratio $\alpha=1$). The top plot shows no formin, the middle plot 0.1 nM formin, and the bottom 1 nM formin. Black dots are formins, blue dots arp 2/3 complex. Filaments are color-coded: blue is linear filaments, yellow is mother filaments, and red is branches.}
\end{figure}



A similar, but more interesting, tale plays out when we increase the concentration of arp 2/3 complex, as shown in Fig.\ \ref{fig:ForminHighArp}. We recall that at this arp 2/3 concentration (200 nM), spontaneous nucleation leads immediately to the formation of branches. Thus, even when we take the highest formin concentrations (1 nM), we never see all of the actin go into linear filaments; in this particular case some 40\% of the actin forms branches immediately. Then, over longer timescales, monomers unbind from existing linear filaments and start to form branches, thus causing the amount of actin in branched structures to grow to roughly 80\% of the total pool by the end of the simulation, regardless of the formin concentration. These dynamics are quite interesting: while high formin concentration forms linear filaments fastest, the rate at which branched structures steal the actin from linear structures is higher. This tells us that the high formin concentration makes a difference in nucleation, but in elongation branching always wins. 

Summing up, higher formin concentration always leads to more filaments being nucleated faster. What happens next depends on the arp 2/3 concentration. When the arp concentration is low, formin will nucleate all of the actin into filaments, and branches will form slowly as branching competes with filament polymerization/treadmilling. When the arp concentration is high, formin will nucleate some of the actin into filaments, but branches will occur simultaneously. While increasing the formin concentration might temporarily lead to more actin in filaments, the branched structures will always catch up because, when the arp concentration is high, the branching rate will dominate the elongation of linear filaments, and monomers which come off of filaments will immediately be incorporated into branches. 

\red{Arp is ``slower'' than formin -- but all it has to do is bind once and the entire thing becomes branched.}

\subsection{Effect of over/under expressing actin}
We now look at what happens when we fix the arp 2/3 concentration (at 200 nM) and formin concentration (at 0.4 nM), and vary the concentration of actin monomers. Figure\ \ref{fig:ActinConc} shows the results of our simulations when we consider actin concentrations of 2 $\mu$M, 5 $\mu$M, and 10 $\mu$M. There appears to be a slight favoring of more branched structures when we have more actin. When there is more actin, fibers nucleate faster, and there are more opportunities for branching. As time proceeds, the nucleation process finishes for lower concentrations, and the percentage of branched vs.\  linear structures evens out. For all concentrations, at $t=3600$ s, 25\% of the actin is in linear filaments. 

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{Conc2Arp200nMFormin4p1_Snaps.eps}
\includegraphics[width=\textwidth]{Conc5Arp200nMFormin4p1_Snaps.eps}
\includegraphics[width=\textwidth]{Conc7p5Arp200nMFormin4p1_Snaps.eps}
\includegraphics[width=\textwidth]{Conc10Arp200nMFormin4p1_Snaps.eps}
\caption{\label{fig:ForminArpsSnaps}Snapshots of polymerization and assembly with 5 $\mu$M actin concentration, 200 nM arp 2/3 concentration, and various formin concentrations (elongation ratio $\alpha=1$). The top plot shows no formin, the middle plot 0.1 nM formin, and the bottom 1 nM formin. Black dots are formins, blue dots arp 2/3 complex. Filaments are color-coded: blue is linear filaments, yellow is mother filaments, and red is branches.}
\end{figure}




\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsVaryConc.eps}
%\includegraphics[width=0.6\textwidth]{FiberDensity_VaryActinConc.eps}
\caption{\label{fig:ActinConc}Course of polymerization and assembly with 200 nM arp 2/3 concentration, 0.4 nM formin concentrations (elongation ratio $\alpha=1$), with actin concentrations 2 $\mu$M (blue), 5 $\mu$M (red), and 10 $\mu$M (yellow). The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}
Make movies also.

\begin{appendices}

\section{Algorithm and validation}
This appendix contains the details of our algorithm and the validation. For validation, we use ODEs, and close the system by assuming a maximum of five monomers per fiber.

\subsection{Stochastic simulation algorithm for spontaneous nucleation \label{sec:SSA}}
Let $\Nm$ be the number of free monomers, $\Nd$ be the number of dimers, and $\Ntr$ be the number of trimers. Then the full reaction list is as follows:
\begin{enumerate}
\item Dimer formation occurs with rate $(\kdp/V)\Nm^2$. If this reaction is chosen, $\Nm$ decreases by 2 and $\Nd$ increases by 1. 
\item Dimer breakup occurs with rate $\kdm \Nd$. If this reaction is chosen, $\Nm$ increases by 2 and $\Nd$ decreases by 1. 
\item Trimer formation occurs with rate $(\ktrp/V)\Nm \Nd $. If this reaction is chosen, $\Nd$ and $\Nm$ decrease by 1 and $\Ntr$ increases by 1. 
\item Trimer breakup occurs with rate $\ktrm \Ntr$. . If this reaction is chosen, $\Nd$ and $\Nm$ increase by 1 and $\Ntr$ decreases by 1. 
\item Tetramer formation occurs with rate $(\kfp/V) \Ntr \Nm$, where $\kfp=\kpp+\kbp$ is the rate at which polymers add monomers to the barbed or pointed end. This reaction decreases $\Nm$ and $\Ntr$ by 1. Once a tetramer is created, we track it as an individual entity which can diffuse in space. We refer to these entities as fibers. 
\item For each fiber, addition of monomers occurs at a rate $(\kfp/V) \Nm$. If this reaction is selected, we add a monomer to the pointed end with probability $p_p^+= \kpp/\kfp$, and add to the barbed end otherwise. We also decrease $\Nm$ by 1. 
\item For each fiber, removal of monomers occurs at rate $\kfm$, where $\kfm=\kpm+\kbm$.  If this reaction is selected, we remove a monomer from the pointed end with probability $p_p^-=\kpm/\kfm$, and remove from the barbed end otherwise. We also increase $\Nm$ by 1. 
\end{enumerate}
We use an exact Gillespie simulation algorithm \cite{gillespie2007stochastic} to simulate these reactions. Letting $F$ be the number of fibers, there are $2F+5$ total reactions with rates $r_i$. We sample a time for these reactions according to an exponential distribution, $\Delta t_i=-\log(u)/r_i$, where $u \in (0,1]$. The reaction chosen is then the one that occurs soonest. We increment time by this minimum amount, then recompute all of the rates and times, repeating until the time step is complete.

\subsection{Validating stochastic simulations with ODEs \label{sec:validationFibs}}
The algorithm in Section\ \ref{sec:SSA} is a stochastic version of the following ODEs  \cite{edelstein1998models} (written by abuse of notation in \emph{concentration} variables)
\begin{subequations}
\label{eq:ODEsMix}
\begin{align}
\frac{d \Nm}{dt} &= -2 \kdp \Nm^2 + 2 \kdm \Nd - \ktrp \Nm \Nd + \ktrm \Ntr + \sum_{j=4}^M \left(- \kfp \Nm N_{j-1}+\kfm N_j\right)\\
\frac{d \Nd}{dt} &= \kdp \Nm^2 - \kdm \Nd -\ktrp \Nd \Nm + \ktrm \Ntr \\
\frac{d \Ntr}{dt} &= \ktrp \Nm \Nd - \ktrm \Ntr - \kfp \Ntr \Nm + \kfm N_4 \\
\frac{d N_j}{dt} & = \kfp \Nm N_{j-1} - \kfm N_j - \kfp N_j \Nm + \kfm N_{j+1} \qquad 4 \leq j < M \\
\frac{d N_M}{dt} & = \kfp \Nm N_{M-1} - \kfm N_M
\end{align}
\end{subequations}
where $M$ represents the maximum number of monomers. Here the cap on the number of monomers is chosen to close the system of equations. Note that these equations could also be written in terms of concentrations instead of number by dividing each side of the equations by the system volume. 

We now validate our stochastic simulations using the ODE system\ \eqref{eq:ODEsMix}. We consider the parameters in Table\ \ref{tab:params}, except that we make the formation of dimers and trimers more favorable by setting $\kdp = 3.5 \times 10^{-3}$ $\mu$M$^{-1}\cdot$s$^{-1}$ and $\ktrp = 1.3$ $\mu$M$^{-1}\cdot$s$^{-1}$ (this represents a factor of 1000 and 10,000 increase over the true values in Table\ \ref{tab:params}, respectively), and use a maximum of $M=5$ monomers per fiber. 

\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{MixedSims.eps}
\caption{\label{fig:MixedSims}Validating the stochastic simulation algorithm for well-mixed systems. We consider the parameters in Table\ \ref{tab:params}, except that we make the formation of dimers and trimers more favorable by setting $\kdp = 3.5 \times 10^{-3}$ $\mu$M$^{-1}\cdot$s$^{-1}$ and $\ktrp = 1.3$ $\mu$M$^{-1}\cdot$s$^{-1}$, and use a maximum of $M=5$ monomers per fiber. The solution of the ODEs\ \eqref{eq:ODEsMix} is shown as a dashed-dotted line, while the results of stochastic simulations with $\Delta t = 5$ s and $\Delta t = 0.5$ s are shown as circles and solid lines, respectively.  }
\end{figure}

Using these parameters, we run the stochastic simulation algorithm in Section \ref{sec:SSA} and compare the results to the ODEs\ \eqref{eq:ODEsMix} in Fig.\ \ref{fig:MixedSims}. We observe agreement between the solution of the deterministic ODEs (dashed-dotted lines) and stochastic simulations with arbitrary time step sizes (Fig.\ \ref{fig:MixedSims} shows $\Delta t=5$ and 0.5 s), validating our implementation. Because our stochastic simulation algorithm is exact, there is no temporal error, and we can make the time step arbitrarily large and still obtain the correct results.

\subsection{Adding formins}
We now repeat the validation experiment from Section\ \ref{sec:validationFibs}, except this time we incorporate the dynamics of formin according to the three rules above. We let $F$ denote the number of formins, and $F_j$ for $2 \leq j \leq M$ denote fibers of length $j$ with formins attached. The ODEs that describe the system are given by\ \eqref{eq:ODEsMix} with the additions (denoted by $+=$ for existing equations)
\begin{align*}
\label{eq:1plus}
\tag{4+}
\frac{d \Nm}{dt} +&= -2\kforn F\Nm^2 - \left(\kpp +\afor \kbp\right)N_1 \sum_{j=2}^{M-1} F_j+\kfm \sum_{j=3}^M  F_j\\
\frac{d N_j}{dt} +& = -\kforp F N_j + \kform F_j \qquad 4 \leq j \leq M
\end{align*}
These additional terms describe the formin nucleation steps and binding/unbinding from existing filaments. The equations that describe the dynamics of formin and the formin-bound filaments are then (once again abusing notation by using $N_j$ and $F_j$ to denote concentration)
\begin{subequations}
\label{eq:ODEsFormin}
\begin{align}
\frac{d F}{dt} &=\kforn F\Nm^2+\kform \sum_{j=4}^{M} F_j - \kforp F \sum_{j=4}^M N_j \\
\frac{d F_2}{dt} &= \kforn F\Nm^2 -\left(\kpp +\afor \kbp\right)N_1F_2 + \kfm F_3 \\
\frac{d F_3}{dt} &= \left(\kpp +\afor \kbp\right)N_1\left(F_2-F_3\right) + \kfm \left(F_4-F_3\right) \\
\frac{d F_j}{dt} & =\left(\kpp +\afor \kbp\right)N_1\left(F_{j-1}-F_j\right) + \kfm \left(F_{j+1}-F_j\right) - \kform F_j + \kforp N_j \qquad 4 \leq j < M \\
\frac{d F_M}{dt} & = \left(\kpp +\afor \kbp\right)N_1 F_{M-1} - \kfm F_M - \kform F_M + \kforp N_M.
\end{align}
\end{subequations}
To validate this system, we use an actin concentration 2 $\mu$M in a box of length 3 $\mu$m on all size, and a formin concentration of 0.1 $\mu$M. The polymerization parameters we use are $\kdp=0.0035$, $\ktrp=1.3$, $\kbp=1.6$, and $\kpp=1.3$, all of these having units $\mu$M$^{-1}\cdot$s$^{-1}$. For depolymerization, we use parameters $\kdm = 0.041$, $\ktrm = 22$, $\kbm=1.4$, $\kpm=0.8$ (all units $s^{-1}$). For formin, we use $\kforn = 0.002$ $\mu$M$^{-2}\cdot$s$^{-1}$, $\kforp = 29.1$ $\mu$M$^{-1}\cdot$s$^{-1}$, $\kforn = 0.081$ $s^{-1}$, and $\afor=2$. As shown in Fig.\ \ref{fig:ForminValid}, the stochastic dynamics we observe agree well with the corresponding ODEs, thereby validating our implementation.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{ForminValidation.eps}
\caption{\label{fig:ForminValid}Validating the stochastic simulation algorithm for well-mixed systems with formins. We use the equations\ \eqref{eq:ODEsMix} (with the additions in\ \eqref{eq:1plus}) for the free-ended fibers (left plot), and the equations\ \eqref{eq:ODEsFormin} for the formin-ended fibers (shown at right). The dynamics from the stochastic simulations agree with the ODEs, thereby validating the algorithm. }
\end{figure}

\subsection{Branched filaments}
Because of the spatial complexity of branched networks, it is difficult to validate depolymerization using ODEs, as it becomes complicated to work out the probability that an unbinding event, if selected, will actually be successful. Because of this, we divide our validation work into two steps: all events \emph{other than} depolymerization, and depolymerization alone. The first case allows us to work with ODEs, as we have done previously, while the second requires us to synthesize a specific structure and look at its depolymerization. 

\subsubsection{ODE-based validation (excludes depolymerization)}
In the case when we disallow unbinding of monomers from barbed and pointed ends of fibers/branches, we have the ODEs\ \eqref{eq:ODEsMix}, \eqref{eq:1plus}, and\ \eqref{eq:ODEsFormin} with $\kfm=\kbm=\kpm=0$, with modifications
\begin{align*}
\label{eq:1plusplus}
\tag{1++}
\frac{dN_1}{dt} +&=-\kbrp N_1 B N_\text{elig}+\kbrm B_1 -\kbp N_1 \sum_{j=1}^{M-1}  B_i -\kbp \afor N_1 \sum_{j=4}^{M-1} F_i \\
\frac{d F}{dt} +&= \sum_{j=4}^{M} \kform R_j - \kforp B_j F,
\end{align*}
where $B_j$ stands for a branch of length $j$, $B$ stands for arp 2/3 complex, and $R_j$ stands for a branch with attached formin of length $j$ (can only be 4 or higher). We then have the following ODEs for the branches (again, assuming that there is no depolymerization)
\begin{subequations}
\label{eq:ODEsBrOnly}
\begin{align}
\frac{dB}{dt} &= -\kbrp N_1 B N_\text{elig}+\kbrm B_1 \\
\frac{d B_1}{dt } &= \kbrp N_1 B N_\text{elig}- \kbrm B_1 -\kbp B_1 N_1 \\
\frac{d B_j}{dt } & = \kbrp N_1 \left(B_{j-1}-B_j\right) \qquad j=2,3\\
\frac{d B_j}{dt} & = \kbrp N_1 \left(B_{j-1}-B_j\right)+\kform R_j - \kforp B_j F \qquad 4 \leq j < M\\
\frac{d B_M}{dt} & = \kbrp N_1 B_{M-1}+\kform R_M - \kforp B_M F\\
\frac{d R_4}{dt} & = -\afor \kbrp N_1 R_4 -\kform R_4 + \kforp B_4 F \\
\frac{d R_j}{dt} & = \afor \kbrp N_1 \left(R_{j-1}-R_j\right)-\kform R_j + \kforp B_j F \qquad 4 < j < M\\
\frac{d R_M}{dt} & = \afor \kbrp N_1 R_{M-1}-\kform R_M + \kforp B_M F
\end{align}
\end{subequations}
To validate this system, we use an actin concentration 2 $\mu$M in a box of length 3 $\mu$m on all size, and a formin and arp 2/3 concentration of 0.1 $\mu$M. The polymerization parameters we use are $\kdp=0.0035$, $\ktrp=1.3$, $\kbp=1.6$, and $\kpp=1.3$, all of these having units $\mu$M$^{-1}\cdot$s$^{-1}$. For depolymerization, we use parameters $\kdm = 0.041$, $\ktrm = 22$, $\kbm=0$, $\kpm=0$ (all units $s^{-1}$; there is no dissociation from barbed/pointed ends). For formin, we use $\kforn = 0.002$ $\mu$M$^{-2}\cdot$s$^{-1}$, $\kforp = 29.1$ $\mu$M$^{-1}\cdot$s$^{-1}$, $\kforn = 0.081$ $s^{-1}$, and $\afor=2$. For branched actin, we set $\kbrp=0.052$ $\mu$M$^{-2}\cdot$s$^{-1}$ and $\kbrm=0.1$ s$^{-1}$. As shown in Fig.\ \ref{fig:GrowArpValid}, the stochastic dynamics we observe agree well with the corresponding ODEs, thereby validating our implementation.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{GrowArpValidation.eps}
\caption{\label{fig:GrowArpValid}Validating the stochastic simulation algorithm for well-mixed systems with formins and arp 2/3 complex, where we only allow growth of fibers. We use the equations\ \eqref{eq:ODEsMix},\eqref{eq:1plus},\eqref{eq:ODEsFormin},\eqref{eq:1plusplus}, and\ \eqref{eq:ODEsBrOnly}, and set $\kfm=\kbm=\kpm=0$, so that fibers can only grow. We show linear filaments at left, formin-bound linear filaments in middle, and branched filaments at right. There $B$ denotes free arp 2/3 complex, $B_5$ is branches of length 5 without formin, and $R_5$ is branches of length 5 with formin.  }
\end{figure}


\subsubsection{Structure-based validation for depolymerization}
\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{BranchedGeo1.eps}
\caption{\label{fig:BranchedGeo}The branched geometry for the depolymerization test. Red points show the mother filament, blue the branches.}
\end{figure}

Let us consider the structure shown in Fig.\ \ref{fig:BranchedGeo}. It is composed of a mother filament with 4 monomers, and then three branches with 6, 8, and 10 monomers. Because each branch is attached to the previous one, our rules state that this filament can only depolymerize linearly. The average time to depolymerize the branches (remove all the blue monomers) should be $21/\kbm+3/\kbrm$, since there are 21 monomers not attached to arp 2/3 and 3 monomers attached to arp 2/3. If $\kbm=1.4$/s and $\kbrm=0.5$/s, this comes out to $6+15=21$ s. To verify that our code reproduces this depolymerization time, we perform a set of 1000 simulations with depolymerization only and record the time it takes for the filament to collapse down to the mother filament. This time is $21.0 \pm 0.3$, which validates our implementation. 

In the case when the mother filament has length 8 instead of 4, the time does not change significantly ($20.9 \pm 0.3$), since the three monomers at the pointed end can unbind rapidly ($\kbp=0.8$/s). The time does change significantly when we put all the branches onto the same barbed end of the mother filament. In this case, all of the branches can depolymerize simultaneously, and the measured time for depolymerization is $9.7 \pm 0.2$ s, which is slightly longer than the theoretical time for the longest branch ($9/\kbm+1/\kbrm=8.4$ s) to unbind, in accordance with the theoretical expectation that the maximum is longer than the longest event.


\end{appendices}



\bibliographystyle{plain}

\bibliography{../../PolarizationBib}


\end{document}
