\documentclass[11pt]{article}
\linespread{1.5} 
\usepackage{graphicx,epstopdf,subfigure,mathtools,mathrsfs, arydshln, amsmath, amssymb} 
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{float}
\usepackage{authblk}
\usepackage[title]{appendix}
\PassOptionsToPackage{usenames,dvipsnames}{xcolor}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage[normalem]{ulem}

\usepackage{amsfonts}
\usepackage{hyperref}
\hypersetup{
    colorlinks=false,
    pdfborder={0 0 0},
}
\newcommand{\new}[1]{\color{blue}#1\normalcolor}
\newcommand{\red}[1]{\color{red}#1\normalcolor}
\newcommand{\delete}[1]{}
\newcommand{\change}[1]{\color{black}#1\normalcolor}
\newcommand{\rev}[1]{\color{black}#1\normalcolor}


% VECTOR AND MATRIX NOTATION
\newcommand{\V}[1]{\boldsymbol{#1}}                 % vector notation
\newcommand{\M}[1]{\boldsymbol{#1}}
\global\long\def\Xin{\V{X}^\text{(in)}}
\global\long\def\Xout{\V{X}^\text{(out)}}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert} 
\newcommand{\Lop}[1]{\boldsymbol{\mathcal{#1}}}
\newcommand{\C}[1]{c_{#1}} 
\renewcommand{\i}[1]{{#1}^{(i)}} 
\renewcommand{\j}[1]{{#1}^{(j)}} 
\newcommand{\z}[1]{{#1}^{(0)}} 
\global\long\def\Rrxn{R_\text{rxn}}
\global\long\def\kdp{k^\text{d+}}
\global\long\def\kdm{k^\text{d-}}
\global\long\def\ktrp{k^\text{t+}}
\global\long\def\ktrm{k^\text{t-}}
\global\long\def\kfp{k^\text{f+}}
\global\long\def\kfm{k^\text{f-}}
\global\long\def\kbp{k^\text{b+}}
\global\long\def\kbm{k^\text{b-}}
\global\long\def\kpp{k^\text{p+}}
\global\long\def\kpm{k^\text{p-}}
\global\long\def\kon{k^\text{on}}
\global\long\def\koff{k^\text{off}}
\global\long\def\kforn{k_\text{for}^{(n)}}
\global\long\def\kforp{k_\text{for}^+}
\global\long\def\kform{k_\text{for}^-}
\global\long\def\kbrp{k^\text{br+}}
\global\long\def\kbrm{k^\text{br-}}
\global\long\def\afor{\alpha_\text{for}}
\global\long\def\Nm{N_1}
\global\long\def\Nd{N_2}
\global\long\def\Ntr{N_3}

\title{Simulations of linear and branched actin networks with formin and arp 2/3 complex as mediators  \vspace{-0.5 cm}}
\author{Ondrej Maxian  \vspace{-0.75 cm}}

\begin{document}
\maketitle

\section{Introduction} 
A great mystery in cell biology is how cells mediate the assembly of different cytoskeletal structures at different times in the cell cycle. One important example of this is branched vs.\ linear actin filament networks. When cells migrate, they form a branched network at their leading edge, which can be important for stable adhesion to a substrate. On the other hand, when cells divide, they form a contractile ring of linear actin filaments. The unidirectional (non-branched) nature of the ring is vital to transmit force in the correct direction for the completion of cytokinesis \cite{alberts}. 

While it is clear that different network architectures are required for different cellular functions, the molecular mechanisms by which cells control the assembly of branched vs.\ linear actin structures are still incompletely understood. At the most basic level, linear actin filaments can assemble in two ways: via formin-mediated assembly, and via spontaneous nucleation \cite{alberts, pollard2007regulation}. Seeing as spontaneous nucleation is highly unfavorable energetically, formin can significantly speed up filament nucleation \cite{rosenbloom2021mechanism} to the point where it dominates assembly dynamics. This is also the case in the presence of profilin \cite{schutt1993structure}, which can block the spontaneous nucleation of filaments, thereby causing filament assembly to be dependent on formin \cite{alberts, pollard1984quantitative}. 

Branched actin networks are dependent on a different assembly factor called the arp 2/3 complex. While this complex can aid in nucleation of linear filaments, assembly is most efficient when it binds to an existing ``mother'' filament. The fixed binding angle of arp 2/3 complex (typically around 70 degrees) causes the formation of tree-like branched actin networks \cite{pollard2007regulation, alberts}. Because the arp 2/3 complex fixes the minus end of the ``daughter'' filament onto the mother, the branches can only grow from their plus ends, and thus branched structures do not exhibit treadmilling and are typically more stable than their linear counterparts \cite{alberts, ni2019turnover, liman2020role}. Unlike formin networks, whose growth is aided by the presence of profilin, arp 2/3-complex-mediated growth is \emph{inhibited} by profilin, which blocks the association of an arp 2/3 activator (WASP VCA) with monomeric actin, a step which is necessary for branch formation \cite{suarez2015profilin}. 

While the key molecular players in branched vs.\ linear network formation are by now well understood, there is still some debate over exactly \emph{how} the cell might program the actin to polymerize into one type of structure vs.\ the other. In the simplest case when there is exactly one structure formed, the kinetics become quite simple: the elongation rate is proportional to a constant times the amount of available (free) actin monomers \cite{suarez2016internetwork}, and the dissociation rate is constant. Solving the simple equation $k_\text{on} C=k_\text{off}$ gives an equilibrium concentration (about 0.1 $\mu$M) at which the structure assumes a steady state size. But introducing multiple structures (either of the same kind or of different types), throws off this balance, as actin assembly kinetics alone do not provide a mechanism for controlling the size (length) or type (linear vs.\ branched) of multiple actin structures \cite{mohapatra2017limiting}. To control this, the conventional viewpoint is that external or internal signals \cite{carlier2017global} activate signaling cascades which eventually cause the cell to produce more or less of a particular type of network \cite{martin2005tea4p, pollard2007regulation, suarez2016internetwork}. However, recent experimental evidence has shown that a limiting actin pool must also play a part in determining the types of structures being produced \cite{burke2014homeostatic}. 

The general evidence for the limiting pool model is as follows: if cells only use signaling to preferentially organize actin into one particular type of structure, then changes in the actin concentration should affect the amount, but not the relative proportion, of linear vs.\ branched networks. However, experiments in fission yeast show that underexpression of actin favors formin-mediated linear structures, while overexpression favors arp 2/3-complex-mediated actin patches \cite{burke2014homeostatic}. Another important set of observations comes from inhibition of arp 2/3 complex. As long as there is sufficient formin, inhibition of arp 2/3 (via drug CK-666) leads to new assembly of filamentous structures, as might be expected (see \cite{xu2023cooperative} for a similar result in plant cells). However, subsequent wash out of CK-666 gives disassembly of the additional filamentous structures and subsequent reassembly of dense actin patches \cite{burke2014homeostatic}. These results suggest that the release of F-actin via disassembly is important for the assembly of new structures \cite{suarez2016internetwork}, and that the occupation of monomers in existing branched structures limits the amount of linear filaments that can be created. Such a scenario was shown to be important in cytokinesis in \emph{C.\ elegans}, where depleting the arp 2/3 complex gives an excess of filamentous actin and consequent delays in cell division \cite{chan2019arp2}. It was also shown that depleting arp 2/3 decreases actin turnover times (by increasing the amount of available actin) in the cortex of \emph{drosophila} embryos \cite{xie2021combinatorial}, demonstrating the versatility of these results across organisms.

These recent \emph{in vivo} experimental studies have spawned a number of \emph{in vitro} and \emph{in silico} (modeling) studies that attempt to understand how a limiting actin pool might set the balance between linear and branched filament networks. Thus far, studies concerned with size control have ignored the precise geometry of branched networks, and have instead looked at filamentous actin structures only, finding that the steady state length distribution of individual filaments (or structures) is not well defined \cite{mohapatra2017limiting,harbage2016exact} because actin kinetics only set the total amount of actin incorporated. In fact, the limiting pool hypothesis predicts that structures with slightly higher on rates will capture all of the monomers at equilibrium \cite{mohapatra2017limiting}. But this is not the behavior we observe \emph{in vivo}, where the balance between branched and filamentous actin is maintained at a relative steady state in time. 

There are a number of potential explanations for why the steady state theory does not match the experimental results. A first possibility is that each individual structure has an inherent mechanism of size control, in particular if there is a net negative feedback in the growth rate as a function of the structure size  \cite{banerjee2022size}. Such feedback could occur through fragmentation and annealing, where longer segments detach and attach to monomers, and fragmentation of longer filaments at steady states balances annealing of shorter ones \cite{fass2008stochastic}. Another mechanism for length-dependent attachment rate could occur in vivo from sensing of the cell boundary \cite{mcinally2021scaling} or from the dynamics of linear filaments in bundles \cite{rosario2023universal}. In fact, recent work \cite{mcinally2023length} has suggested that size control can also emerge in a feedback-independent way if filaments form bundles (couples the dynamics of multiple filaments into one structure) and are removed randomly from the bundle with an independent probability (leads to a steady state because long filaments eventually get removed). 

A second possibility for why the \emph{in vivo} experiments do not match steady state predictions is more obvious: what if the cell simply is not operating at steady state? Indeed, it has been shown that intermediate filament lengths are quasi-stable on timescales of a few hours, and that the drift to steady state occurs on timescales as long as days \cite{hu2007theoretical,suarez2017enough}. The intermediate-timescale regime was the focus of \cite{banerjee2022emergence}, where it was found that spontaneous nucleation of actin filaments gives rise to a quasi-stable, near-uniform length distribution, which can change to exponential in the presence of capping protein. This kind of length distribution does not match the expected steady state exponential one \cite{edelstein1998models}, because it is only stable on intermediate timescales. Nevertheless, these timescales, which are on the order of tens of minutes to a few hours, are the most relevant in \emph{in vitro} experiments and in the cell itself, where cell-cycle cues typically take place every few hours to change the environment. 

%\red{There are additional confounding agents that could tip the scales in one direction or the other. We focus on two: profilin and capping protein. In general, the presence of profilin correlates with more filamentous actin structures \cite{suarez2016internetwork}, as actin binding to profilin prevents filament nucleation but allows for barbed end growth \cite{pollard2007regulation}. Depletion of capping protein increases arp 2/3-mediated patches by at least 35\% \cite{suarez2016internetwork}. This is confusing because capping protein competes with formin for barbed ends \cite{kovar2005profilin}, and so we would expect depleting capping protein to increase formin levels and lead to more filamentous actin.}

\subsection{The focus of this study}
It is therefore clear that further study is necessary to clear up how the balance of actin assembly changes on short to intermediate to long timescales. In addition, while previous size-control studies are pleasingly general \cite{banerjee2022size, mohapatra2017limiting}, the fact remains that branched actin networks \emph{require} the presence of linear filaments to form, and so the specific modeling of branched and linear networks is necessary to truly understand how formin and arp 2/3 complex compete for actin monomers. Our goal in this study is to address these two points: by specifically modeling branched and linear networks, we can get an idea of how a limiting actin pool alone can give rise to different network architectures. And by simulating dynamically, we can understand how long the quasi-steady states with near uniform filament length distributions can persist in time \cite{banerjee2022emergence}. 

Because some of the \emph{in vitro} experiments on these systems pattern formin in one place and arp 2/3 complex in another, it will be important to look at the spatial dynamics of the filaments. Yet, because the nucleation reactions are reaction-limited, and because most reaction rates are reported in terms of bulk concentrations, it makes little sense to explicitly track actin monomers in space. Because of this, we settle on a hybrid approach where we treat actin nucleates as bulk quantities, which form fibers at random points in space. While we will not do so in this draft, our approach can be extended to incorporate diffusion, hydrodynamics, and explicit forces on the filaments which affect their dynamics. %Once the fibers form, we track their positions explicitly. Because we will not consider hydrodynamic interactions in this system, the Brownian dynamics approach is straightforward \cite{makino2004brownian, delong2015brownian}. 

The simulation approach we employ is an amalgamation of previous work \cite{fass2008stochastic, ni2019turnover, banerjee2022emergence}. As in \cite{fass2008stochastic, banerjee2022emergence}, we use a stochastic simulation algorithm to simulate a list of well-mixed reactions involving filaments and formins, but in this work we add the simulation of branched actin networks. Similar to \cite{ni2019turnover, liman2020role}, we explicitly simulate branched actin networks, since their geometry (the number of branches and length of each branch) determines the rate of monomer binding and the possibility of arp 2/3 complex binding to form another branch. Unlike in \cite{ni2019turnover}, however, we do not explicitly track individual actin monomers in space, which allows us to reach longer time and lengthscales. Specifically, we do not introduce seed filaments to skip the lag phase of actin assembly \cite{chandrasekaran2022nucleation}, and are consequently able to explicitly simulate the actin nucleation reactions proposed in \cite{rosenbloom2021mechanism} to obtain a more accurate picture of how formin-based nucleation competes with spontaneous nucleation. Combining tools from these previous works allows us to study, for the first time to our knowledge, the spatial and temporal dynamics of how formins and arp 2/3 compete for actin monomers to form linear vs.\ branched networks.

We begin this report where others have left off: stochastic simulation of actin filament dynamics. In Section \ref{sec:FilAct}, we review what by now is a well-established approach to the simulation of filament assembly, except that we incorporate the most complete picture of spontaneous nucleation developed in \cite{rosenbloom2021mechanism}. We simulate the dynamics of F-actin assembly both with and without formins, which we assume can both nucleate new filaments and speed the rate of elongation at the barbed end. Then, in Section\ \ref{sec:BF}, we lay out our model of branched filaments, including how they form from a combination of arp 2/3 complex and existing filaments. We then simulate the formation of branched actin structures with and without formin.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}\hline
Parameter & Description & Value & Units \\ \hline
%$a$ & Actin diameter & 4 & nm & & \\
%$k_B T$ & Thermal energy & $4.1 \times 10^{-3}$ & pN$\cdot \mu$m & & \\ 
%$\mu$ & Fluid viscosity & 0.01 & Pa$\cdot$s & & $D=2k_BT/(6 \pi \mu a)\approx 11$ $\mu$m$^2$/s \\  \hline
$\kdp_0$ & Dimer formation rate& $3.5 \times 10^{-6}$ & $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$\kdp$ & Dimer formation rate& $5.8 \times 10^{-9}$ & $\mu$m$^{3} \cdot$s$^{-1}$ & & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\kdm_0$ & Dimer dissociation rate & 0.041 & s$^{-1}$\\
$\ktrp_0$ & Trimer formation rate& $13 \times 10^{-5}$ & $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$\ktrp$ & Trimer formation rate& $2.2 \times 10^{-7}$ & $\mu$m$^{3} \cdot$s$^{-1}$ &  & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\ktrm_0$ & Trimer dissociation rate & 22 & s$^{-1}$ \\
$\kbp_0$ & Barbed end addition rate& 11.6 & $\mu$M$^{-1}\cdot$s$^{-1}$ \\ 
%$k_b^+$ &  Barbed end addition rate& 0.019 & $\mu$m$^{3} \cdot$s$^{-1}$ &  & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\kbm_0$ & Barbed end dissociation rate & 1.4 & s$^{-1}$\\
$\kpp_0$ & Pointed end addition rate& 1.3& $\mu$M$^{-1}\cdot$s$^{-1}$  \\ 
%$k_p^+$ &  Pointed end addition rate& $2.2 \times 10^{-3}$ & $\mu$m$^{3} \cdot$s$^{-1}$ & & 1 $\mu$M=602.2 $\mu$m$^{-3}$ \\
$\kpm_0$ & Pointed end dissociation rate & 0.8 & s$^{-1}$ \\ \hline
\end{tabular}
\caption{\label{tab:params} Parameter values for filament nucleation and growth \cite{rosenbloom2021mechanism}. }
\end{center}
\end{table}



\section{Stochastic simulations of filamentous actin \label{sec:FilAct}}
%The previous section showed that the actin nucleation reaction is severely reaction-limited, and that the steady state can be well-approximated assuming that the system is well mixed. Because of this, we seem to be wasting quite a lot of effort tracking the diffusion of individual monomers, especially since tracking them requires us to search for neighbors at every time step. The need to search for reaction neighbors led us to a first-order accurate reaction scheme for simplicity, which limits the time step size so that $k\Delta t \ll 1$, where $k$ is the \emph{fastest} reaction rate (binding of a monomer to a barbed end). Figure\ \ref{fig:FiveRealP} showed that this requires $\Delta t \approx 10^{-4}$ s, and we are interested in simulating timescales on the order of $10^3$ to $10^4$ s. These simulations, while doable, would be quite costly. 
This section discusses our algorithm for linear filaments. The process of actin polymerization can be separated into a nucleation step and elongation step. In the nucleation step, two actin monomers come together to form a dimer, which then must be joined by another monomer to form a trimer. A trimer has a barbed and pointed end, and monomers can associate at those ends with the same rate as longer filaments. The reactions in the system are therefore: dimer formation and breakup, trimer formation and breakup, and polymerization and depolymerization from the barbed/pointed end of each filament. Table\ \ref{tab:params} lists the parameters, which come from the recent study \cite{rosenbloom2021mechanism}.

As already mentioned in the introduction, we do not explicitly track ``filaments'' (really nucleates) of length 3 or smaller, instead only keeping a count of how many are in the system. Once a tetramer forms, we insert it randomly into the spatial domain and start to track its location explicitly. This allows us to retain some spatial dependence (which will be necessary later when we try to mimic \emph{in vitro} experiments) while not wasting computational time on steps we know are well mixed. Thus, in our system, the key unknowns are the number of monomers, dimers, and trimers, and the length (and coordinates in space) of each filament. 

We also incorporate actin binding proteins into our simulations. We allow for two types of proteins: one which binds to actin monomers in solution, and then is kicked off when the actin incorporates into filaments (e.g., profilin, thymosin-$\beta$4, TTH-1), and another which binds to the barbed ends of existing filaments (e.g., formin, capping protein). These barbed-binding proteins can also nucleate new filaments. With this information, simulations become defined by a set of \emph{binding} rates $k_{ij}$, which is the rate at which monomers bound to protein $i$ bind to fibers whose barbed ends are bound by protein $j$, and another set of \emph{unbinding} rates $k_j$, which is the rate at which fibers with barbed end bound by protein $j$ depolymerize. Section\ \ref{sec:SSA} gives more details on the implementation of this stochastic reaction scheme. 

\subsection{Simulations of actin polymerization without spatial dynamics}
We now perform stochastic simulations of actin polymerization using the algorithm in Section\ \ref{sec:SSA}. In these simulations, we do not simulate the diffusion of the fibers, as there is no reason to do so if we are not interested in spatial information. We consider systems with various concentrations of monomers (2,5, and 10 $\mu$M) in a box of size $125$ $\mu$m$^3$ (5 $\mu$m on each side). 

\begin{figure}
\centering
\subfigure[Dynamics of polymerization]{
\includegraphics[width=0.48\textwidth]{FreeActinTimeConc.eps}
\includegraphics[width=0.48\textwidth]{FibersTimeConc.eps}}
\subfigure[Distribution of fiber sizes]{
\includegraphics[width=\textwidth]{LengthDistsConc.eps}}
\caption{\label{fig:ActinPolyMix}Stochastic simulations of polymerization dynamics at three different concentrations. (a) The dynamics of polymerization, with the concentration of free monomers shown at left and the number of fibers per unit volume (1 $\mu$m$^3$) shown at right. The number of fibers comes to a steady state when about half the actin is depleted. (b) The distribution of fiber sizes (in terms of the number of monomers) at three different time points for each concentration.}
\end{figure}

Figure\ \ref{fig:ActinPolyMix} shows the results of our simulations. The dynamics can be divided into a ``lag phase'' for nucleation (which is longer for smaller concentrations), followed by a ``growth phase'' (in which free actin is incorporated into the existing fibers), terminated by an ``equilibrium phase.'' At the end of the lag phase, the number of fibers per volume reaches a steady state, so that in the growth phase the decrease in free actin is driven exclusively by incorporation into existing fibers. After the growth phase is complete, the concentration of free actin remains constant at 0.17 $\mu$M, and the fibers must exchange monomers with other fibers to grow in length \cite{hu2007theoretical}.

Similar to \cite{banerjee2022emergence}, we do not concern ourselves with the long-time ``steady state'' distribution of actin filament lengths, which can take days to reach \cite{hu2007theoretical, fass2008stochastic, mohapatra2017limiting}, and instead focus on the length distributions on an intermediate timescale of a 30 minutes to 3 hours, which corresponds to a typical timescale for \emph{in vitro} experiments. Our results for the filament length distributions, which are shown in Fig.\ \ref{fig:ActinPolyMix}(b), match those of \cite{banerjee2022emergence} for spontaneous nucleation of filaments: intermediate timescales show a quasi-stable length distribution which is skewed to the left and quite broad (c.f.\ \cite[Fig.~2c]{banerjee2022emergence}), and higher concentrations have lower mean filament lengths (since more filaments are nucleated faster, the filaments that are nucleated first do not suck up as many monomers prior to nucleation of other filaments). 

\subsection{Incorporating formins}
We now incorporate formin into the filament dynamics. We assume that formin can do three things,
\begin{enumerate}
\item Formin can nucleate filaments by binding two actin monomers in the reaction $F+A+A \rightarrow FA_2$, which is irreversible and has rate $\kforn$ \cite{paul2008role, zweifel2021nucleation}. Following previous studies \cite{paul2008role, zweifel2021nucleation}, we do not allow formin nucleates to break apart.
\item This fiber can add monomers to the barbed and pointed ends, with a modified rate at the barbed end $\afor \kbp$. It can also depolymerize from both ends with the normal rates (until it becomes a trimer).
\item Formin can bind and unbind from existing filaments (2 or more monomers) barbed ends, with rates $\kforp$ and $\kform$, respectively. 
\end{enumerate}

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}\hline
Parameter & Description & Value & Units & Ref  \\ \hline
$\kforn$ & Filament nucleation by formin & $2 \times 10^{-4}$ & $\mu$M$^{-2}\cdot$s$^{-1}$& \cite[Tab.~S1]{paul2008role}  \\ 
$\kforp$ & Formin association to barbed ends& 29.1 & $\mu$M$^{-1} \cdot $s$^{-1}$ & \cite{shekhar2015formin} \\
$\kform$ & Formin dissociation from barbed ends& $5 \times 10^{-4}$ & s $^{-1}$ & \cite{kovar2006control}\\
$\afor$ &Growth for formin barbed ends (no profilin) & 0.5 & & \cite{kovar2006control}\\ \hline
\end{tabular}
\caption{\label{tab:paramsF} Parameter values for formin. We choose an average of values reported in literature for the mammalian formin mDia1 and mDia2 (with the exception of nucleation which comes from budding yeast data Bni1p.)}
\end{center}
\end{table}

We choose to model the mammalian formins mDia1 and mDia2, which are able to nucleate filaments from free actin monomers. For these formins, association of free monomers to barbed ends with bound formin takes place at roughly 50\% the rate it does without formin \cite{kovar2006control}. The key rates are reported in Table\ \ref{tab:paramsF}, and Appendix \ref{sec:ForRateDet} reports how we translate these rates into inputs to the simulation. 

\subsubsection{Results with formin}
\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{FreeMonConcFormin.eps}
\includegraphics[width=0.48\textwidth]{FractionFreeFormin.eps}
\includegraphics[width=0.48\textwidth]{PercentForminBoundNoprof.eps}
\includegraphics[width=0.48\textwidth]{FibersPerVolFormin.eps}
\caption{\label{fig:ActinNucWithFormin}Dynamics of actin polymerization (at 5 $\mu$M) when formin nucleates actin filaments, and barbed end growth with formin attached occurs at 50\% of the free-ended rate. Top left: the concentration of free actin monomers over time. The colors correspond to different formin concentrations. Top right: the fraction of free formins over time. Bottom left: the percentage of fibers that have a formin-bound barbed end. Bottom right: the number of fibers per unit volume. The solid lines give the total density of filaments per volume, while the dotted lines give the density of formin-bound filaments.}
\end{figure}

We now consider how adding formin affects the dynamics of actin polymerization at a fixed actin concentration of 5 $\mu$M. Figure\ \ref{fig:ActinNucWithFormin} shows the concentration of free monomers, fraction of free formins, and fiber density (with and without bound formins) from simulations lasting 3600~s, in which we include formin at concentrations varying from 0 to 2 nM. In all cases, we see how formin aids the process of nucleation; at time shorter than 60 seconds, most (almost all for formin concentrations larger than 0.1 nM) of the filaments created are formin-bound, regardless of the formin concentration. As time goes on, this percentage decreases in proportion to the amount of formin in the system, as spontaneous nucleation gives filaments without bound ends. There is then a long-time steady state where formin assumes an equilibrium with about 7\% unbound. The long time steady state demonstrates that the number of fibers is large enough in all cases for formin to assume an equilibrium state (there is never an excess of formins, because at higher formin concentrations more filaments are nucleated).

At low ($\leq 0.2$ nM) formin concentrations, the dynamics of polymerization closely resemble the spontaneous nucleation case; we see that it takes about 1500 s to reach the steady state concentration of free monomers. As we increase the formin concentration, the nucleation phase is faster (bottom right plot), going from about 300 s for no formin to 100 s with formin. The faster nucleation phase occurs because more filaments are nucleated. The nucleation of additional filaments leads to a faster growth phase, since there are more barbed ends available to bind actin monomers. Thus, despite the fact that formin-bound barbed ends grow more slowly than free barbed ends, the additional barbed ends still lead to a faster growth phase. If we define the growth phase as the time it takes the free monomer concentration to go from 90\% to 10\%, we obtain a time of $252-30\approx 200$ s with 2 nM formin, compared to $1080-144 \approx 1000$ s without formin. With 2 nM formin, there are ten times as many filaments, but each filament grows at half the speed, which gives a factor of five difference in the dynamics.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{LengthHistsFormin.eps}
\caption{\label{fig:HistsWithFormin}Length distribution for actin filaments in simulations with formin of varying concentrations. We show the distributions of fiber sizes (in terms of the number of monomers) at four time points ($t=600$ s in blue, $t=1200$ s in red, $t=2400$ s in yellow, and $t=3600$ s in purple). The distributions become more uniform (smaller range) as the formin concentration increases.}
\end{figure}

How do these dynamics affect the length distribution of fibers? As shown in Fig.\ \ref{fig:HistsWithFormin}, and as previously reported in \cite{banerjee2022emergence}, an increase in the formin concentration leads to the nucleation of more filaments at early times, which translates to a smaller mean and standard deviation in the number of monomers per filament. The slower speed of formin-filament growth leads to a bimodality in the distribution of filament lengths; this is especially clear in the case of 0.1 nM formin, where there is a peak at $2 \times 10^4$ which matches the non-formin-bound fibers, along with a second peak around $1 \times 10^4$ monomers for formin-bound fibers. When the formin concentration increases, we typically observe a large peak associated with formin-bound fibers. This peak tends to lose mass over time, with growth occurring for larger numbers of monomers. This reflects the theoretical expectation that the slower growing fibers (the formin-bound ones) will give up their actin over long times to the faster-growing (non formin-bound) ones \cite{mohapatra2017limiting}. 

\subsection{Explicitly incorporating profilin}

\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{ActinProfilinEq.eps}
\caption{\label{fig:ProfilinEq}How the profilin:actin equilibrium affects the fraction of free actin. Here the $x$ axis shows the ratio of profilin to actin, while the $y$ axis shows the fraction of free monomers that result. Because of nonlinearities in the equilibrium, the curves are different for different actin concentrations. The dotted black curve shows the result if all the profilin binds to actin.}
\end{figure}


Profilin is a protein which binds actin monomers in solution. The binding reaction has forward rate 45 $\mu$M$^{-1}\cdot$s$^{-1}$ and reverse rate 10 s$^{-1}$. At typical profilin concentrations of order 1 $\mu$M, this reaction is much faster than the other reactions in the system, which means we can approximate it as in instantaneous equilibrium. Appendix\ \ref{sec:SSA} discusses how we do this; in Fig.\ \ref{fig:ProfilinEq} we show the resulting fraction of free actin as a function of the profilin actin ratio. At low profilin concentrations, all of the profilin binds to actin, while at higher concentrations the equlibrium is more complex.  

In our simulations, monomers bound to profilin cannot nucleate new filaments (dimers), regardless of whether or not they are assisted by formin \cite{paul2009review}. Without formin, profilin-bound monomers bind barbed ends at a rate 80\% of the free monomer value, while with formin the binding rate is 300\% of the free monomer value (these represent average rates for mDia1 and mDia2 from \cite{kovar2006control}). Binding at the pointed end with profilin-bound monomers is small (10\% of the free monomer value). See Appendix\ \ref{sec:ForRateDet} for how these rates are incorporated into simulations. 

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{DynamicsProfilinOnly.eps}
\includegraphics[width=0.48\textwidth]{FractionFreeProfilin.eps}
\includegraphics[width=\textwidth]{LengthDistsProfilin.eps}
\caption{\label{fig:ActinProfilin}Dynamics of actin polymerization (at 5 $\mu$M) with profilin. Top left: the concentration of free actin monomers over time. The colors correspond to different profilin concentrations. Top right: the number of fibers per volume over time. Bottom: fiber length distributions over time for 2 $\mu$M profilin (left), 3 $\mu$M profilin (middle), and 4 $\mu$M profilin (right).}
\end{figure}

We begin our study by looking at how profilin affects polymerization without formin. Figure\ \ref{fig:ActinProfilin} compares the dynamics of polymerization of 5 $\mu$M actin with varying profilin concentrations in the range 0 to 5 $\mu$M. Low profilin concentrations do not show too much of a change from the spontaneous nucleation curves, since at 1 $\mu$M profilin concentration we only expect about 20\% of the monomers to be bound to profilin. Increasing the profilin concentration has drastic effects; once we reach 5 $\mu$M profilin, the growth phase is not complete by $t=3$ hours. The slowdown in polymerization is driven by two factors: first, profilin has a reduced rate of binding for both pointed and barbed ends, which slows down the rate of polymerization. Second and more importantly, increases in profilin lead to less filaments being nucleated, which means there are less barbed ends available to bind monomers. The length distributions for each profilin concentration show another effect of having less filaments; each filament tends to be longer, and the distributions are more spread out. The reason for the latter is that there is no longer a big nucleation event that spawns many filaments. There are only a few filaments in the system, and the length of each filament is directly correlated with the time since it was nucleated.

\subsubsection{Formin (high concentration) with profilin}
\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{FreeMonConcForminProf.eps}
\includegraphics[width=0.48\textwidth]{FractionFreeForminProf.eps}
\includegraphics[width=0.48\textwidth]{PercentForminBoundProf.eps}
\includegraphics[width=0.48\textwidth]{FibersPerVolForminProf.eps}
\caption{\label{fig:ActinForProf}Dynamics of actin polymerization (at 5 $\mu$M) with 1 nM formin and various profilin concentrations. Top left: the concentration of free actin monomers over time. The colors correspond to different formin concentrations. Note the non-monotonic dependence of overall monomer depletion on profilin concentration. Top right: the fraction of free formins over time. Bottom left: the percentage of fibers that have a formin-bound barbed end. Bottom right: the number of fibers per unit volume. In addition to the colors representing different concentrations, the solid lines give the total density of filaments per volume, while the dotted lines give the density of formin-bound filaments.}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{LengthHistsForminProf.eps}
\caption{\label{fig:HistsForProf}Length distribution for actin filaments in simulations with 1 nM formin and varying concentrations of profilin. We show the distributions of fiber sizes (in terms of the number of monomers) at four time points ($t=300$ s in blue, $t=600$ s in red, $t=1800$ s in yellow, and $t=5400$ s in purple). Increasing profilin concentration gives less filaments, which translates to a more uniform-looking distribution with larger mean and standard deviation.}
\end{figure}


We now consider the effect of adding formin at concentration 1 nM. At this formin concentration, we previously saw (Fig.\ \ref{fig:ActinNucWithFormin}) that about 80\% of the fibers are bound to formin in the absence of profilin. Figure\ \ref{fig:ActinForProf} shows the results of polymerization with formin in the presence of profilin. There is an interesting trade-off in the polymerization dynamics: on the one hand, profilin inhibits nucleation by formin, so the nucleation phase is slower with profilin. On the other hand, once filaments are nucleated, profilin-actin binds at a faster rate to the barbed end than actin without profilin. This process is auto-catalytic: as more profilin-actin binds to fibers, profilin is released, and there is more of it in solution, which means more of the actin monomers are profilin bound. As a result, low profilin concentrations of 1--3 $\mu$M have dynamics which are \emph{faster} than actin without profilin.


Unlike for the case without formin, with formin the behavior with increasing profilin concentration is non-monotonic: at higher profilin concentrations (4--5 $\mu$M), the increased growth rate at barbed ends cannot compensate for the smaller number of fibers, and the dynamics are slower. The smaller number of fibers occurs because formin has to nucleate filaments from \emph{free} actin monomers, which are less abundant as the profilin concentration increases. For these high concentrations, formin must do the nucleating, since spontaneous nucleation is too slow. That said, only a few fibers are nucleated before elongation takes over, and there is a seeming paradox where there are more filaments bound to formin as the profilin concentration increases, but more free formins. This is resolved by noting that there are substantially fewer fibers with increasing profilin concentration. The smaller number of filaments gives longer filaments (see Fig.\ \ref{fig:HistsForProf}).

\begin{figure}
\centering
\includegraphics[width=0.48\textwidth]{FreeMonConcForminLowProf.eps}
\includegraphics[width=0.48\textwidth]{FractionFreeForminLowProf.eps}
\includegraphics[width=0.48\textwidth]{PercentForminBoundLowProf.eps}
\includegraphics[width=0.48\textwidth]{FibersPerVolForminLowProf.eps}
\caption{\label{fig:ActinForLowProf}Dynamics of actin polymerization (at 5 $\mu$M) with 0.1 nM formin and various profilin concentrations. Top left: the concentration of free actin monomers over time. The colors correspond to different formin concentrations. Top right: the fraction of free formins over time. Bottom left: the percentage of fibers that have a formin-bound barbed end. Bottom right: the number of fibers per unit volume. In addition to the colors representing different concentrations, the solid lines give the total density of filaments per volume, while the dotted lines give the density of formin-bound filaments.}
\end{figure}

Decreasing the formin concentration to 0.1 nM (Fig.\ \ref{fig:ActinForLowProf}) gives the same trends as for 1 nM formin concentration. We observe initially faster speeds of polymerization for 1--3 $\mu$M profilin concentrations, followed by slower speeds for 4 and 5 $\mu$M profilin. Increasing profilin concentration gives less fibers, a higher percentage of which are formin bound, and more free formins. 


\section{Stochastic simulations of branched filaments \label{sec:BF}}
We now discuss our model of filament branching. Similar to previous work \cite{ni2019turnover}, we consider the binding of arp 2/3 complex to a linear filament, which results in the formation of a branch whose tangent vector makes a seventy degree angle with the mother filament \cite{pollard2007regulation}. Previous work \cite{beltzner2008pathway} has shown that the kinetics of actin monomers binding VCA-bound arp 2/3 complex are much faster than this complex (with or without a monomer attached) binding to an existing filament. Therefore, letting $B$ be a VCA-bound arp 2/3 complex and $N_j$ a filament of any size, the reaction proceeds in two steps
\begin{subequations}
\label{eq:BothRxnsArp}
\begin{align}
\label{eq:fastrxn}
B + N_1 \xleftrightarrow{K_\text{fast}} BN_1 \qquad & \text{(fast)}\\
BN_1 + N_j \overset{k_\text{slow}^+}{\underset{k_\text{slow}^-}\rightleftarrows} BN_1N_j \qquad & \text{(slow)}
\end{align}
\end{subequations}
To simplify this, we assume the fast reaction is in equilibrium and coarse grain this process into a single reaction involving three reactants: (VCA-bound) arp 2/3 complex $B$, an actin monomer $N_1$, and an actin filament $N_j$, 
\begin{equation}
\label{eq:ArpRxn}
B + N_1 + N_j \overset{\kbrp}{\underset{\kbrm}\rightleftarrows} BN_1N_j. 
\end{equation}
The negative rate for this reaction is obtained from \cite{beltzner2008pathway},
\begin{gather*}
\kbrm = k_\text{slow}^- = 3.4 \times 10^{-3} \, \text{s}^{-1},
\end{gather*}
while the positive rate can be obtained directly from the \emph{in vitro} TIRF data in \cite{smith2013pathway}. In this study, which uses budding yeast (for which branching is possible without bound VCA), the rate of branching is measured in units of $\mu$M$^{-1}\cdot$s$^{-1}$ per $\mu$m of mother filament. Because the branching occurs in a background of 1 $\mu$M monomeric actin, we can extrapolate the rate to the correct units by dividing by the background concentration to obtain
\begin{gather*}
\kbrp \approx 5 \times 10^{-3} \, \mu \text{M}^{-2} \cdot \text{s}^{-1}/(\mu\text{m of mother filament}).
\end{gather*}
This rate is an approximation, and represents a midpoint between the rate in the presence of VCA ($9.7 \times 10^{-3}$) and the rate in its absence ($2.5 \times 10^{-3}$). 




Prior to stating the new reactions we incorporate, it is necessary to first list the geometric constraints that develop when we introduce branched networks. To simplify the process of polymerization and depolymerization, we implement the following rules:
\begin{enumerate}
\item A filament is eligible to form a branch when it has $N_\text{mb}=4$ monomers or more. Once a branch forms, it forms on the fourth monomer or higher (the first three monomers cannot form branches). 
\item The pointed end of the mother cannot unbind if a branch is sitting on the fourth monomer. This always leaves two monomers between the pointed end and the first branch. 
\item The barbed end (of a mother or a branch) cannot unbind if another branch is attached to it. 
\item Branches can only unbind if they have length 1, in which case arp 2/3 also detaches from the filament (reverse of reaction\ \eqref{eq:ArpRxn}). ``Barbed ends'' alone cannot unbind if branches have length 1 (the only unbinding is through the reverse of reaction\ \eqref{eq:ArpRxn}).
\item Formin can bind and unbind from branches with length 4 or more. In the low probability event that a branch depolymerizes to 1 monomer with a formin bound to it, that branch is prevented form unbinding. 
\end{enumerate}
This set of rules ensures simplicity in the construction and deconstruction of branched structures (in essence, the structure has to depolymerize in the order it was constructed, and cannot break into multiple branched structures). While these rules are certainly a simplification, our goal here is to study the percentage of monomers in branched structures, so whether one structure with 40 branches should in fact be two structures with 20 branches is of little consequence to us. 



\subsection{Branching with spontaneous nucleation \label{sec:BrSN}}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{FreeMons_Arp.eps}
\includegraphics[width=0.6\textwidth]{FiberDensity_Arp.eps}
\caption{\label{fig:PolyDynamicsArp}Course of polymerization and assembly with 5 $\mu$M actin concentration and various concentrations of arp 2/3 (2 nM in blue, 20 nM in red, and 200 nM in yellow). The top row of plots shows how the concentration of monomers changes between free monomers (left), linear filaments (middle), and branched structures (right). The bottom plot shows the density of fibers per unit volume for each concentration, separated into linear filaments and mothers of branches (dashed-dotted line), and branches (dotted line).  }
\end{figure}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{MotherLengths_Arp23.eps}
\includegraphics[width=\textwidth]{BranchLengths_Arp23.eps}
\caption{\label{fig:LengthDistsArp} The length distribution of filaments with 5 $\mu$M actin concentration and various concentrations of arp 2/3 (2 nM at left, 20 nM in the middle, and 200 nM at right). We separate the filaments into linear and mother filaments, and show their length distribution at the top, and branches, with their length distribution at the bottom. }
\end{figure}

We begin by looking at the branching process with spontaneous nucleation of actin filaments only (no formins). We fix the actin concentration at 5 $\mu$M and vary the concentration of arp 2/3 across an orders of magnitude (20 nM, 80 nM, and 200 nM). The dynamics of polymerization and assembly are shown in Fig.\ \ref{fig:PolyDynamicsArp}, and the filament length distributions are shown in Fig.\ \ref{fig:LengthDistsArp}. 

To understand these data, it is important to remember that actin filament polymerization with spontaneous nucleation proceeds in two phases: nucleation of filaments (slow), and then elongation (fast). Obviously, nucleation of filaments is a prerequisite for branching. So in this simplified model, the two timescales that compete are the timescale of elongation and branching. Indeed, while it is true that in the limit of time to infinity we might expect to always see branched structures, if the timescale of branching is too slow we might never see any branching. This is the case at very low (20 nM) Arp 2/3 concentrations, where our results show over 80\% of the polymerized actin in linear filaments. Thus, in this regime, the timescale of branching is slower than both nucleation and elongation, and there is very little branching. 

If we increase the branched concentration to 80 nM, we see different dynamics. In this case, the number of mothers and linear fibers is the same as for 20 nM, so the branching is still sufficiently slow as to not affect the number of filaments nucleated. But when the filaments grow (on timescale between 500 and 1000 s), we see increases in the number of monomers in both branched structures and in branches. Thus elongation and branching have roughly the same timescales. In the long-time limit, we see the number of monomers in linear filaments slowly decrease as the monomers are exchanged into branched structures (although the changes are not too large, even at the highest concentration).

Finally, when we consider a concentration of 200 nM, there is a significant change in the \emph{number} of mother and linear filaments, which indicates that the branching competes with nucleation for monomers (the timescale of branching is now so fast that nucleates immediately form branches before more nucleates can form). Here we see rapid depletion of the monomer pool (faster than for 20 and 80 nM), as well as depletion of the monomers in linear filaments as more and more branches are built. 

Further understanding of the dynamics can be gained by looking at the length distributions in Fig.\ \ref{fig:LengthDistsArp}, where we have made separate distributions for linear fibers (including mothers of branches) in the top set of plots, and branches in the bottom set. For 20 nM Arp 2/3 concentration, the length distributions look similar to the case without arp 2/3, where a quasi-steady state is achieved at roughly 1000 s (there are very few branches here). For 20 nM Arp 2/3 concentration, fibers still get longer in the initial stages, but branches are formed at the same time, and there is a rough quasi-steady state in the distribution of branch lengths (this reflects the fact that branching and elongation occur on similar timescales here). By contrast, for 200 nM Arp 2/3 concentration, the quasi-steady state in the linear fibers occurs at an early time, and they do not elongate past $2 \times 10^4$ monomers. It is instead branches which form, in particular new branches, as the distribution of branch lengths becomes more and more concentrated on smaller branches over time. This is in line with our previous observation that branching is faster than elongation. The formation of new branches at later times demonstrates that, at the 200 nM concentration, there is an excess of arp 2/3 which looks for available monomers to form new branches. 


\subsection{Adding formins}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsForminLowArp.eps}
\includegraphics[width=0.6\textwidth]{FibersForminLowArp.eps}
\caption{\label{fig:ForminLowArp}Course of polymerization and assembly with 5 $\mu$M actin concentration, 20 nM arp 2/3 concentration, and various formin concentrations and elongation ratios $\alpha$. The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}


We now add formins to see how they affect the balance of linear vs.\ branched filaments. As in Section\ \ref{sec:FilAct}, here we separate our results into those that consider formin as a nucleator only ($\afor=1$), and those that also consider formin being able to elongate filaments faster or slower ($\afor \neq 1$). 

\subsubsection{Formin as a nucleator}
Based on the results for spontaneous nucleation in Section\ \ref{sec:BrSN}, our expectation is that increased nucleation by formin will speed up the initial rate of linear filament formation, which will take monomers away from potential branched structures. This is exactly what we see for low Arp 2/3 concentration (20 nM) in Fig.\ \ref{fig:ForminLowArp}. At this concentration, we know that branching is not fast enough to occur at the same time as spontaneous nucleation, instead competing with elongation for monomers. Because of this, the initial dynamics at low arp concentration are dominated by formin nucleation dynamics. At zero or small (0.1 nM) formin concentrations, nucleation is not fast enough to overwhelm branching, and some of the initial monomer pool goes right to branches. However, when there is more formin (1 nM concentration), there is more nucleation, and all of the possible monomers rapidly get incorporated into linear filaments. The limiting amount of arp then prevents these filaments from becoming branched, and we see more linear structures. 

\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsForminHighArp.eps}
\includegraphics[width=0.6\textwidth]{FibersForminHighArp.eps}
\caption{\label{fig:ForminHighArp}Course of polymerization and assembly with 5 $\mu$M actin concentration, 200 nM arp 2/3 concentration, and various formin concentrations and elongation ratios $\alpha$. The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}

A similar, but more interesting, tale plays out when we increase the concentration of arp 2/3 complex, as shown in Fig.\ \ref{fig:ForminHighArp}. We recall that at this arp 2/3 concentration (200 nM), the delay between filament nucleation and branch formation is much shorter, so that branch formation competes with nucleation of additional filaments for monomers. Thus, even when we take the highest formin concentrations (1 nM), we never see all of the actin go into linear filaments; in this particular case some 60\% of the actin forms branches immediately. Then, over longer timescales, monomers unbind from existing linear filaments and start to form branches, causing the amount of actin in branched structures to grow to roughly 80\% of the total pool by the end of the simulation. Overall, while high formin concentration forms linear filaments fastest, the rate at which branched structures steal the actin from linear structures is higher. This tells us that the high formin concentration makes a difference in nucleation, but in elongation branching always wins at high arp concentration.

\subsubsection{Formin elongation}
Let us now consider what happens when we change the formin elongation factor $\afor$. In Fig.\ \ref{fig:ForminArpAlpha}, we fix the actin (5 $\mu$M), formin (1 nM), and Arp 2/3 (200 nM) concentrations, and vary the elongation ratio $\afor$ of the formins. If we examine the amount of monomers in branched structures, we see that the initial nucleation phase is roughly the same. The interesting dynamics come in the growth phase: when $\afor$ is large, the linear filaments suck up much more of the actin. The effect of $\afor$ is actually two-fold: in addition to faster growth, there are also less filaments when $\afor$ is large, and thus not as many branches can form. When $\afor$ is higher, these two factors translate to a slower rate of branch structures removing monomers from linear structures in the ``equilibrium'' phase.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{DynamicsForminArpAlpha.eps}
\includegraphics[width=0.6\textwidth]{FibersForminArpAlpha.eps}
\caption{\label{fig:ForminArpAlpha}Course of polymerization and assembly with 5 $\mu$M actin concentration, 200 nM arp 2/3 concentration, and 1 nM formin concentrations with various elongation ratios $\afor$. The top plots show the concentration of free monomers, monomers in linear filaments, and monomers in branched structures. The bottom plot shows the dynamics of fiber and branch growth. }
\end{figure}


\begin{appendices}

\section{Algorithm and validation}
This appendix contains the details of our algorithm and the validation. For validation, we use ODEs, and close the system by assuming a maximum of five monomers per fiber.

\subsection{Stochastic simulation algorithm for linear filaments \label{sec:SSA}}
To keep our algorithm general, let us suppose that we have $P_M$ proteins which bind to monomers in solution, and are kicked off of the monomers once they bind to fibers. We also assume that there are $P_B$ proteins which bind barbed ends of actin filaments. Letting $M$ be the total number of free actin monomers, and $\z{M}$ the amount of free actin monomers attached to no protein. The equilibrium reactions
\begin{subequations}
\label{eq:MonEq}. 
\begin{gather}
\z M + \i{P} \xleftrightarrow{\i{\kappa}} \i{M} \\
\i{M} = \i{\kappa} \z M  \left(\i{P}-\i M\right)\rightarrow \i M = \frac{\i \kappa \z M \i P}{1+\i \kappa \z M}
\end{gather}
dictate the number of monomers attached to protein $i \geq 1$. In the case when there is only one monomer, the equation
\begin{gather}
\z M + M^{(1)} = \z M + \frac{ \kappa^{(1)} \z M P^{(1)}}{1+\kappa^{(1)} \z M}=M
\end{gather}
can be solved to obtain a closed-form solution for the amount of free monomers
\begin{gather}
\z M = \frac{1}{2 \kappa^{(1)} }\left(-\left(1+\kappa^{(1)}\left(P^{(1)}-M\right)\right) + \sqrt{\left(1+\kappa^{(1)}\left(P^{(1)}-M\right)\right)^2+ 4 \kappa^{(1)}M}\right). 
\end{gather}
Thus, prior to calculating any reaction rates, the first step of our reaction algorithm is to compute the number of monomers attached to each protein using\ \eqref{eq:MonEq}. 
\end{subequations}

For our reactions, we let $\kdp_{ij}$ be the rate of dimer formation for monomers bound to protein $i$ (starting from 0, to include no bound protein), and barbed end bound to protein $j$ (starting from 0, again to include no protein). Likewise, $\ktrp_{ij}$ is the rate of trimer formation, and $\kfp_{ij}$ is the rate of addition to fibers (length 3 or more). The rate of addition to fibers is broken into $\kfp_{ij}=\kpp_i + \kbp_{ij}$, since the pointed end rate is assumed to depend only on the protein bound to the monomer, while the barbed end addition rate depends on both bound proteins. The rates of unbinding $\kfm_j=\kpm+\kbm_j$ are a function of the barbed-bound protein only. Finally, we let $\kon_j$ and $\koff_j$ be the rates of binding and unbinding of the barbed end proteins. 

Given this notation, the next reaction method proceeds as follows: at the beginning of each step, we compute the total number of monomers bound to each protein via\ \eqref{eq:MonEq}. Then, we sample a time for each of the following reactions to occur:
\begin{enumerate}
\item \emph{Spontaneous dimer formation}. For all $i$ and $j=0$, dimer formation occurs with rate $(\kdp_{i0}/V)\i M \i M$. %If this reaction is chosen, $M$ decreases by 2 and $\z B_2$ increases by 1. 
\item \emph{Barbed-bound-protein-induced nucleation.} For all $i$ and $j> 0$, dimer formation occurs with rate $(\kdp_{ij}/V^2)\i M \i M \j B$. %If this reaction is chosen, $M$ decreases by 2, $\j B$ decreases by 1, and $\j B_2$ increases by 1. 
\item \emph{Dimer break-up.} For all $j$, each individual dimer breaks up with rate $\kdm_j$. %This results in $M$ increasing by 2 and $\j B_2$ decreasing by 1. If $j>0$, then $\j B$ also increases by 1. 
\item \emph{Trimer formation.} For all $i$ and $j$, each individual dimer becomes a trimer with rate $(\ktrp_{ij}/V)\i M$.
\item \emph{Trimer breakup.} For all $j$, each individual trimer breaks up with rate $\ktrm_j$.
\item \emph{Fiber growth.} For each individual fiber of length 3 or more, fiber growth occurs with rate $(\kfp/V) \i M$, where $\kfp=\kpp_i+\kbp_{ij}$.
\item \emph{Fiber shrinkage.} For each individual fiber of length 4 or more with barbed bound protein $j$, removal of monomers occurs at the barbed end with rate $\kbm_j$ and at the pointed end with rate $\kpm$ (this is actually two reactions). 
\item \emph{Barbed protein binding.} Barbed protein $j$ binds to each fiber of length 2 or more with rate $\kon_j  \j B$. 
\item \emph{Barbed protein unbinding.} Barbed protein $j$ unbinds from each fiber that it is attached to with rate $\koff_j$.
\end{enumerate}
We use an exact Gillespie simulation algorithm \cite{gillespie2007stochastic} to simulate these reactions. If a reaction has rate $r_i$, we sample a time for it to occur according to an exponential distribution, $\Delta t_i=-\log(u)/r_i$, where $u \in (0,1]$. The reaction chosen is then the one that occurs soonest. Once a reaction is chosen, we increment time by this minimum amount and process the reation by changing the state of the system to reflect its outcome (e.g., unbinding from the barbed end removes one monomer from a filament and adds it to the free monomer count). We then repeat this entire process (including the calculation of bound monomers in \eqref{eq:MonEq}) until the time step is complete. Because this is an exact simulation algorithm, the time step $\Delta t$ is arbitrary and is not a restriction on accuracy.

To efficiently implement these reactions, we take an approach where we track a number of fiber nucleates, which we denote as $\j B_m$ for $m=2, 3$. Once fibers reach a size of four, we create an object in space to track each of them individually. 

\subsubsection{Algorithm validation}
We validate our stochastic simulation algorithm by comparing to ODEs. To facilitate this, we must cap the length of fibers at a maximum size $M$, which we set to $M=5$. To formulate the ODEs, we begin by defining the rate at which monomers become dimers with the barbed end bound with protein $j$. Given the rates and reactions defined in Section\ \ref{sec:SSA}, this rate is given by 
\begin{subequations}
\label{eq:ODEs}
\begin{gather}
\z R_2 = \sum_{i=0}^{P_M} \left(\kdp_{i0} \i M \i M\right)-\kdm_0 \z B_2 \qquad R_2^{(j>0)} =  \sum_{i=0}^{P_M} \left(\kdp_{ij} \i M \i M \j B\right) - \kdm_j \j B_2
\end{gather}
The rate at which dimers become trimers is given by 
\begin{gather}
\j R_3 = \sum_{i=0}^{P_M} \left(\ktrp_{ij} \i M \j B_2\right) - \ktrm _j \j B_3, 
\end{gather}
and the rates at which fibers of larger sizes are formed are 
\begin{gather}
\label{eq:GM}
\j R_m = \sum_{i=0}^{P_M} \left(\kfp_{ij} \i M \j B_{m-1}\right) - \kfm  \j B_m, \qquad 4 \leq m \leq M.
\end{gather}
Finally, the rate at which barbed binding proteins bind and unbind from the bound end of a fiber of size $m$ is 
\begin{gather}
\label{eq:BX}
\j S_m = \kon_j \j B \z B_m - \koff_j \j B_m. 
\end{gather}
With these intermediates defined, the ODEs that govern the dynamics are 
\begin{gather}
\frac{dM}{dt}= \sum_{j=0}^{P_B} \left(-2\j R_2 -\sum_{m=3}^M \j R_m\right) \\
\frac{d \j B}{dt } = -\j R_2-\j S_m   \\
\frac{d \j B_m}{dt} = 
\begin{cases} 
\j R_m - \j R_{m+1}-\j S_m & j =0,\quad 2\leq m < M  \\
\j R_m - \j R_{m+1}+\j S_m & j > 0,\quad  2\leq m < M\\
\j R_m -\j S_m & j =0,\quad m=M  \\
\j R_m +\j S_m & j > 0,\quad  m=M
 \end{cases}
\end{gather} 
\end{subequations}
We validate our code by comparing the ODEs to stochastic simulations with the following rates
\begin{gather}
\nonumber
\kdp_{ij} = 3.5 \times 10^{-3} \, \mu \textrm{M}^{-1} \cdot \text{s}^{-1} \begin{pmatrix} 1 & 0.57 \, \mu \textrm{M}^{-1} \\ 1.7 & 0.29  \, \mu \textrm{M}^{-1}\end{pmatrix} \qquad 
\ktrp_{ij} = 0.13 \, \mu \textrm{M}^{-1} \cdot \text{s}^{-1} \begin{pmatrix} 1 & 10 \\ 0.4 & 2\end{pmatrix} \\ \label{eq:ODERates}
\kbp_{ij} = 1.6 \, \mu \textrm{M}^{-1} \cdot \text{s}^{-1} \begin{pmatrix} 1 & 2 \\ 0.2 & 2.5\end{pmatrix} \qquad \kpp_i = 1.3 \, \mu \textrm{M}^{-1} \cdot \text{s}^{-1} \begin{pmatrix} 1 & 0.25 \end{pmatrix}\\ \nonumber
\kappa_1 = 5 \, \mu \text{M} \qquad P^{(1)}=0.05 \, \mu \text{M} \qquad B^{(1)}(t=0)= 0.1 \, \mu \text{M}\qquad   \kon_1 = 5 \, \mu \textrm{M}^{-1} \cdot\text{s}^{-1}\qquad \koff_1 = 8.1 \times 10^{-2} \, \text{s}^{-1}  \\ \nonumber
\kdm_j = 0.041 \, \text{s}^{-1} \begin{pmatrix} 1 & 0.2 \end{pmatrix} \qquad 
\ktrm_j = 22 \, \text{s}^{-1} \begin{pmatrix} 1 & 0.4 \end{pmatrix}\qquad 
\kpm = 0.8 \, \text{s}^{-1} \qquad \kbm = 1.4 \, \text{s}^{-1}\begin{pmatrix} 1 & 0.1 \end{pmatrix}
\end{gather}
Figure\ \ref{fig:ForminValid} shows that the solution of the ODEs (dashed-dotted lines) matches the output from stochastic simulations, thus validating all parts of our algorithm up to the branching of filaments. 

\begin{figure}
\centering
\includegraphics[width=\textwidth]{ForminValidation.eps}
\caption{\label{fig:ForminValid}Validating the stochastic simulation algorithm with one monomer-binding and one barbed-binding protein. We consider an actin concentration of 2 $\mu$M in a box of size 3 $\mu$m on each side, and the rates given in \eqref{eq:ODERates}. The dashed-dotted lines show the concentration (in units $\mu$m$^{-3}$) of each particular species ($\j B_m$ denotes a polymer of size $m$ with barbed protein $j$ bound to it) predicted by the ODEs\ \eqref{eq:ODEs}. The solid lines with error bars show the output from the stochastic simulations. These data points show the mean over 3 sets of 10 simulations, with the error bars the standard error in the mean.   }
\end{figure}

\subsubsection{Rates for formin and profilin \label{sec:ForRateDet}}
In the language of our simulation platform, the rates with formin and profilin are
\begin{gather*}
\kon_1 = 29.1 \, \mu \textrm{M}^{-1} \cdot\text{s}^{-1}\qquad \koff_1 = 5 \times 10^{-4} \, \text{s}^{-1}  \\ \nonumber
\kdm_j = \kdm_0 \begin{pmatrix} 1 & 0 \end{pmatrix} \qquad 
\ktrm_j = \ktrm_0 \begin{pmatrix} 1 & 0 \end{pmatrix}\qquad 
\kbm = \kbm_0 \begin{pmatrix} 1 & 1 \end{pmatrix},\\
\nonumber
\kdp_{ij} = \kdp_0 \begin{pmatrix} 1 & 0.057 \, \textrm{nM}^{-1} \\ 0 & 0  \, \textrm{nM}^{-1} \end{pmatrix} \qquad 
\ktrp_{ij} =\ktrp_0 \begin{pmatrix} 1 & 5.5 \times 10^4 \\ 0 & 2.8 \times 10^5 \end{pmatrix} \\
\kbp_{ij} =\kbp_0 \begin{pmatrix} 1 & 0.5 \\ 0.8 & 3 \end{pmatrix} 
\qquad 
\kpp_{i} =\kpp_0 \begin{pmatrix} 1 & 0.1 \\ \end{pmatrix}.
\end{gather*}
where the base rates are given in Table\ \ref{tab:params}. Note the large rate for the trimers; we assume that formin-bound dimers become trimers with rate $\afor \kbp_0+\kpp_0$, which is divided by $\ktrp_0$ to obtain the proportion ($\afor$ is 0.5 without profilin and 3 with profilin). We assume that formin bound dimers and trimers do not depolymerize.

\subsection{Branched filaments}
Given the set of rules formulated in Section\ \ref{sec:BF}, we can now formulate the reactions involving arp 2/3 complex. Letting $D$ be the number of free arp 2/3 complexes, the reactions are
\begin{enumerate}
\item \emph{Branch formation.} Each fiber (or branch) of length 4 or more can form a branch with rate $r=\left(\kbrp_i/V^2\right) D \i M m$, where $m$ is the number of monomers on the fiber. If this reaction is selected, we form a new branch with one monomer at a 70 degree angle from the mother filament (chosen at random from the branches once a particular structure is selected).
\item \emph{Branch unbinding.} Branches of length one can come off the mother filament with rate $\kbrm$.
\item \emph{Branch polymerization.} For each $i$, branches can polymerize from their barbed ends only with rate $\left(\kbp_{ij}/V\right) \i M$. 
\item \emph{Branch depolymerization.} Branches can depolymerize from their barbed ends with rate $\kbm$, as long as the geometry permits it (see rules above).
\item \emph{Barbed protein binding and unbinding.} These are the same reactions as for linear fibers. 
\end{enumerate}

Because of the spatial complexity of branched networks, it is difficult to validate depolymerization using ODEs, as it becomes complicated to work out the probability that an unbinding event, if selected, will actually be successful. Because of this, we divide our validation work into two steps: all events \emph{other than} depolymerization, and depolymerization alone. The first case allows us to work with ODEs, as we have done previously, while the second requires us to synthesize a specific structure and look at its depolymerization. 

\subsubsection{ODE-based validation (excludes depolymerization)}
In the presence of branching, additional terms are required for the ODEs. We let $D$ be the number of arp 2/3 complexes, and $\j D_m$ be a branch of length $m$ with barbed-bound protein $j$. If $\kbrp$ is a rate of branching in units of concentration$^{-2}$ $\times$ s$^{-1}$ per monomer of mother filament, the total rate of branch formation is 
\begin{subequations}
\label{eq:BrODEs}
\begin{equation}
\label{eq:Rb}
R_b =  D\left(\sum_{i=0}^{P_M}\kbrp_i \i M\right) \left(\sum_{j=0}^{P_B} \sum_{m=4}^M m \j D_m\right)-\kbrm \sum_j \j D_1.
\end{equation}
In addition to forming and being removed, branches exchange barbed proteins with rates given by\ \eqref{eq:BX}, and the flux between branches of size $m$ and size $m-1$ is given by
\begin{gather}
\j C_m = \sum_{i=0}^{P_M} \left(\kbp_{ij} \i M \j D_{m-1}\right) - \kbm  \j D_m, \qquad 2 \leq m \leq M,
\end{gather}
which is\ \eqref{eq:GM} with polymerization from the barbed end only. It is straightforward to combine these rates into equations for $D$ and $\j D_m$. The only complication becomes if a depolymerization event is successful.
\end{subequations}
For branching, we combine the rates in\ \eqref{eq:ODERates} with the additional branching rates, 
\begin{gather}
\label{eq:BrRates}
\kbrp_i = 10^{-2} \,\mu \text{M}^{-2}\cdot\text{s}^{-1}\begin{pmatrix} 1 & 1.3 \end{pmatrix} \qquad \kbrm=0.5 \, \text{s}^{-1} D(t=0)=0.1 \, \mu \text{M}
\end{gather}
to validate our code \emph{without} depolymerization of barbed and pointed ends (i.e., $\kbm=\kpm=0$). Figure\ \ref{fig:GrowArpValid} shows that the trajectories we obtain from simulations (mean over 10  trajectories repeated 3 times for error bars) match those predicted by the ODEs.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{GrowArpValidation.eps}
\caption{\label{fig:GrowArpValid}Validating the stochastic simulation algorithm with formins and arp 2/3 complex, where we only allow growth of fibers. We compare our stochastic simulations to ODEs (based on\ \eqref{eq:ODEs} and\ \eqref{eq:BrODEs} with rates given in\ \eqref{eq:ODERates} and \eqref{eq:BrRates}). }
\end{figure}

\subsubsection{Structure-based validation for depolymerization}
\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{BranchedGeo1.eps}
\caption{\label{fig:BranchedGeo}The branched geometry for the depolymerization test. Red points show the mother filament, blue the branches.}
\end{figure}

Let us consider the structure shown in Fig.\ \ref{fig:BranchedGeo}. It is composed of a mother filament with 4 monomers, and then three branches with 6, 8, and 10 monomers. Because each branch is attached to the previous one, our rules state that this filament can only depolymerize linearly. The average time to depolymerize the branches (remove all the blue monomers) should be $21/\kbm+3/\kbrm$, since there are 21 monomers not attached to arp 2/3 and 3 monomers attached to arp 2/3. If $\kbm=1.4$/s and $\kbrm=0.5$/s, this comes out to $6+15=21$ s. To verify that our code reproduces this depolymerization time, we perform a set of 1000 simulations with depolymerization only and record the time it takes for the filament to collapse down to the mother filament. This time is $20.9 \pm 0.2$ (error bar generated by repeating 20 times), which validates our implementation. 

In the case when the mother filament has length 8 instead of 4, the time does not change significantly ($21.1 \pm 0.5$), since the three monomers at the pointed end can unbind rapidly ($\kpm=0.8$/s). The time does change significantly when we put all the branches onto the same barbed end of the mother filament. In this case, all of the branches can depolymerize simultaneously, and the measured time for depolymerization is $9.9 \pm 0.1$ s, which is slightly longer than the theoretical time for the longest branch ($9/\kbm+1/\kbrm=8.4$ s) to unbind, in accordance with the theoretical expectation that the expected value maximum is longer than the expected value of the longest event.


\end{appendices}



\bibliographystyle{plain}

\bibliography{../../PolarizationBib}


\end{document}
